[{"content":" ÈÄôÊòØ What Is New in MySQL 8.4 since MySQL 8.0 ÁöÑÁ≥ªÂàóÊñáÔºå\nÊúÉÈáùÂ∞çÈÉ®ÂàÜÊàëË¶∫ÂæóË∑üÊó•Â∏∏Á∂≠ÈÅãÊúâÈóúÁöÑÊõ¥ÂãïÁâπÂà•Á†îÁ©∂Ôºå\nÂÖ∂È§òÁöÑÂ∞±Áï∂ÊïÖ‰∫ãÊõ∏ÔºåÁúãÈÅéÁü•ÈÅìÂç≥ÂèØ Introduction #Logging of the shutdown process was enhanced, with the addition of startup and shutdown messages for the MySQL server, plugins, and components. Such messages are now also logged for closing connections. These additions should facilitate troubleshooting and debugging problems, particularly in the event that the server takes an excessively long time to shut down.\nFor more information, see Section 7.4.2, \u0026ldquo;The Error Log\u0026rdquo;.\nAdditions to server startup and shutdown messages.\nAdded the following types of messages to the server startup and shutdown processes as noted in this list:\nStart and end messages for server initialization when the server is started with --initialize or --initialize-insecure; these are in addition to and distinct from those shown during normal server startup and shutdown. Start and end messages for InnoDB initialization. Start and end messages for init file execution during server initialization. Start and end messages for for execution of compiled-in statements during server initialization. Start and end mesages for crash recovery during server startup (if crash recovery occurs). Start and end messages for initialization of dynamic plugins during server startup. Start and end messages for compoenents initialization step (apparent during server startup). Messages for shutdown of replica threads, as well as graceful and forceful shutdown of connection threads, during server shutdown. Start and end messages for shutdown of plugins and components during server shutdown. Exit code (return value) information with shutdown messages during initialization or server shutdown and end) In addition, if the server was built using WITH_SYSTEMD, the server now includes every systemd message in the error log.\n‰ª•‰∏äÂºïÁî®Ëá≥ÂÆòÊñπÂéüÊñá\nSummary #ÁúãÂÆåÁöÑÊÑüÊÉ≥Âè™Êúâ‰∏ÄÂè•Ôºå\nÊúâÁî®Ôºå‰ΩÜ‰∏çÂ§ö üòÇ\n‰∏ªË¶ÅÊòØÂä†Âº∑‰∫Ü Error Log ÁöÑË©≥Á¥∞Á®ãÂ∫¶Ôºå\nÂú® Startup ‰ª•Âèä Shutdown Á≠âÈöéÊÆµÊúâÁ¥ÄÈåÑÊõ¥Ë©≥Á¥∞ÁöÑË≥áË®ä\nË´ãÂèÉËÄÉ‰ª•‰∏ãÂ∑ÆÁï∞\nStartup #MySQL 8.4 #2025-11-10T11:46:28.906838+08:00 0 [Note] [MY-013930] [Server] systemd notify: STATUS=Server startup in progress 2025-11-10T11:46:28.907406+08:00 0 [System] [MY-015015] [Server] MySQL Server - start. 2025-11-10T11:46:29.132294+08:00 0 [Warning] [MY-010097] [Server] Insecure configuration for --secure-log-path: Current value does not restrict location of generated files. Consider setting it to a valid, non-empty path. 2025-11-10T11:46:29.132341+08:00 0 [Note] [MY-013932] [Server] BuildID[sha1]=862ccd8e790deea6de418ff7f6cd35f12b7bcb65 2025-11-10T11:46:29.132346+08:00 0 [Note] [MY-010949] [Server] Basedir set to /usr/. 2025-11-10T11:46:29.132356+08:00 0 [System] [MY-010116] [Server] /usr/sbin/mysqld (mysqld 8.4.6-6) starting as process 14556 2025-11-10T11:46:29.140143+08:00 0 [Note] [MY-012366] [InnoDB] Using Linux native AIO 2025-11-10T11:46:29.140429+08:00 0 [Note] [MY-010747] [Server] Plugin \u0026#39;FEDERATED\u0026#39; is disabled. 2025-11-10T11:46:29.140514+08:00 0 [Note] [MY-010747] [Server] Plugin \u0026#39;ndbcluster\u0026#39; is disabled. 2025-11-10T11:46:29.140538+08:00 0 [Note] [MY-010747] [Server] Plugin \u0026#39;ndbinfo\u0026#39; is disabled. 2025-11-10T11:46:29.140555+08:00 0 [Note] [MY-010747] [Server] Plugin \u0026#39;ndb_transid_mysql_connection_map\u0026#39; is disabled. 2025-11-10T11:46:29.140636+08:00 0 [Note] [MY-010747] [Server] Plugin \u0026#39;mysql_native_password\u0026#39; is disabled. 2025-11-10T11:46:29.141921+08:00 1 [Note] [MY-013930] [Server] systemd notify: STATUS=InnoDB initialization in progress 2025-11-10T11:46:29.141982+08:00 1 [System] [MY-013576] [InnoDB] InnoDB initialization has started. 2025-11-10T11:46:29.142017+08:00 1 [Note] [MY-013546] [InnoDB] Atomic write enabled 2025-11-10T11:46:29.142051+08:00 1 [Note] [MY-012932] [InnoDB] PUNCH HOLE support available 2025-11-10T11:46:29.142074+08:00 1 [Note] [MY-012944] [InnoDB] Uses event mutexes 2025-11-10T11:46:29.142091+08:00 1 [Note] [MY-012945] [InnoDB] GCC builtin __atomic_thread_fence() is used for memory barrier 2025-11-10T11:46:29.142108+08:00 1 [Note] [MY-012948] [InnoDB] Compressed tables use zlib 1.3.1 2025-11-10T11:46:29.145247+08:00 1 [Note] [MY-012951] [InnoDB] Using hardware accelerated crc32 and polynomial multiplication. 2025-11-10T11:46:29.145710+08:00 1 [Note] [MY-012203] [InnoDB] Directories to scan \u0026#39;./\u0026#39; 2025-11-10T11:46:29.145779+08:00 1 [Note] [MY-012204] [InnoDB] Scanning \u0026#39;./\u0026#39; 2025-11-10T11:46:29.369955+08:00 1 [Note] [MY-012208] [InnoDB] Completed space ID check of 6 files. 2025-11-10T11:46:29.371608+08:00 1 [Note] [MY-012955] [InnoDB] Initializing buffer pool, total size = 5.250000G, instances = 1, chunk size =128.000000M 2025-11-10T11:46:29.371656+08:00 1 [Note] [MY-011872] [InnoDB] Setting NUMA memory policy to MPOL_INTERLEAVE 2025-11-10T11:46:31.289344+08:00 1 [Note] [MY-011874] [InnoDB] Setting NUMA memory policy to MPOL_DEFAULT 2025-11-10T11:46:31.289467+08:00 1 [Note] [MY-012957] [InnoDB] Completed initialization of buffer pool 2025-11-10T11:46:31.325996+08:00 0 [Note] [MY-011952] [InnoDB] If the mysqld execution user is authorized, page cleaner thread priority can be changed. See the man page of setpriority(). 2025-11-10T11:46:31.358951+08:00 1 [Note] [MY-013532] [InnoDB] Using \u0026#39;./#ib_16384_0.dblwr\u0026#39; for doublewrite 2025-11-10T11:46:31.401994+08:00 1 [Note] [MY-013532] [InnoDB] Using \u0026#39;./#ib_16384_1.dblwr\u0026#39; for doublewrite 2025-11-10T11:46:31.426588+08:00 1 [Note] [MY-013566] [InnoDB] Double write buffer files: 2, --innodb-doublewrite-files=2, segments_per_file=2 2025-11-10T11:46:31.426665+08:00 1 [Note] [MY-013565] [InnoDB] Double write buffer pages per instance: 128 2025-11-10T11:46:31.426704+08:00 1 [Note] [MY-013532] [InnoDB] Using \u0026#39;./#ib_16384_0.dblwr\u0026#39; for doublewrite 2025-11-10T11:46:31.426737+08:00 1 [Note] [MY-013532] [InnoDB] Using \u0026#39;./#ib_16384_1.dblwr\u0026#39; for doublewrite 2025-11-10T11:46:31.501928+08:00 1 [Note] [MY-013883] [InnoDB] The latest found checkpoint is at lsn = 30303787 in redo log file ./#innodb_redo/#ib_redo0. 2025-11-10T11:46:31.502072+08:00 1 [Note] [MY-013086] [InnoDB] Starting to parse redo log at lsn = 30303787, whereas checkpoint_lsn = 30303787 and start_lsn = 30303744 2025-11-10T11:46:31.515397+08:00 1 [Note] [MY-013083] [InnoDB] Log background threads are being started... 2025-11-10T11:46:31.558635+08:00 1 [Note] [MY-012532] [InnoDB] Applying a batch of 0 redo log records ... 2025-11-10T11:46:31.558720+08:00 1 [Note] [MY-012535] [InnoDB] Apply batch completed! 2025-11-10T11:46:31.560227+08:00 1 [Note] [MY-013252] [InnoDB] Using undo tablespace \u0026#39;./undo_001\u0026#39;. 2025-11-10T11:46:31.581489+08:00 1 [Note] [MY-013252] [InnoDB] Using undo tablespace \u0026#39;./undo_002\u0026#39;. 2025-11-10T11:46:31.588080+08:00 1 [Note] [MY-012910] [InnoDB] Opened 2 existing undo tablespaces. 2025-11-10T11:46:31.588224+08:00 1 [Note] [MY-011980] [InnoDB] GTID recovery trx_no: 3601 2025-11-10T11:46:31.809137+08:00 1 [Note] [MY-013776] [InnoDB] Parallel initialization of rseg complete 2025-11-10T11:46:31.809229+08:00 1 [Note] [MY-013777] [InnoDB] Time taken to initialize rseg using 2 thread: 221 ms. 2025-11-10T11:46:31.809334+08:00 1 [Note] [MY-012923] [InnoDB] Creating shared tablespace for temporary tables 2025-11-10T11:46:31.810230+08:00 1 [Note] [MY-012265] [InnoDB] Setting file \u0026#39;/var/lib/mysql/ibtmp1\u0026#39; size to 12 MB. Physically writing the file full; Please wait ... 2025-11-10T11:46:31.845956+08:00 1 [Note] [MY-012266] [InnoDB] File \u0026#39;/var/lib/mysql/ibtmp1\u0026#39; size is now 12 MB. 2025-11-10T11:46:31.846143+08:00 1 [Note] [MY-013627] [InnoDB] Scanning temp tablespace dir:\u0026#39;./#innodb_temp/\u0026#39; 2025-11-10T11:46:31.865616+08:00 1 [Note] [MY-013018] [InnoDB] Created 128 and tracked 128 new rollback segment(s) in the temporary tablespace. 128 are now active. 2025-11-10T11:46:31.875582+08:00 1 [Note] [MY-012976] [InnoDB] Percona XtraDB (http://www.percona.com) 8.4.6-6 started; log sequence number 30303797 2025-11-10T11:46:31.876880+08:00 1 [System] [MY-013577] [InnoDB] InnoDB initialization has ended. 2025-11-10T11:46:31.876936+08:00 1 [Note] [MY-013930] [Server] systemd notify: STATUS=InnoDB initialization successful 2025-11-10T11:46:31.958653+08:00 1 [Note] [MY-011089] [Server] Data dictionary restarting version \u0026#39;80300\u0026#39;. 2025-11-10T11:46:32.076265+08:00 1 [Note] [MY-013930] [Server] systemd notify: STATUS=InnoDB crash recovery in progress 2025-11-10T11:46:32.102885+08:00 1 [Note] [MY-012357] [InnoDB] Reading DD tablespace files 2025-11-10T11:46:32.103635+08:00 1 [Note] [MY-012356] [InnoDB] Scanned 8 tablespaces. Validated 8. 2025-11-10T11:46:32.117174+08:00 1 [Note] [MY-013930] [Server] systemd notify: STATUS=InnoDB crash recovery successful 2025-11-10T11:46:32.130646+08:00 1 [Note] [MY-010006] [Server] Using data dictionary with version \u0026#39;80300\u0026#39;. 2025-11-10T11:46:32.131943+08:00 0 [Note] [MY-013930] [Server] systemd notify: STATUS=Initialization of dynamic plugins in progress 2025-11-10T11:46:32.140199+08:00 0 [Note] [MY-011332] [Server] Plugin mysqlx reported: \u0026#39;IPv6 is available\u0026#39; 2025-11-10T11:46:32.141815+08:00 0 [Note] [MY-011323] [Server] Plugin mysqlx reported: \u0026#39;X Plugin ready for connections. bind-address: \u0026#39;::\u0026#39; port: 33060\u0026#39; 2025-11-10T11:46:32.141868+08:00 0 [Note] [MY-011323] [Server] Plugin mysqlx reported: \u0026#39;X Plugin ready for connections. socket: \u0026#39;/var/lib/mysql/mysqlx.sock\u0026#39;\u0026#39; 2025-11-10T11:46:32.142041+08:00 0 [Note] [MY-013930] [Server] systemd notify: STATUS=Initialization of dynamic plugins successful 2025-11-10T11:46:32.191009+08:00 0 [Note] [MY-010902] [Server] Thread priority attribute setting in Resource Group SQL shall be ignored due to unsupported platform or insufficient privilege. 2025-11-10T11:46:32.194618+08:00 0 [Note] [MY-010856] [Server] Failed to open the crashed binlog file when source server is recovering it. 2025-11-10T11:46:32.203368+08:00 0 [Note] [MY-013911] [Server] Crash recovery finished in binlog engine. No attempts to commit, rollback or prepare any transactions. 2025-11-10T11:46:32.203423+08:00 0 [Note] [MY-013911] [Server] Crash recovery finished in InnoDB engine. No attempts to commit, rollback or prepare any transactions. 2025-11-10T11:46:32.205909+08:00 0 [Note] [MY-012487] [InnoDB] DDL log recovery : begin 2025-11-10T11:46:32.206890+08:00 0 [Note] [MY-012488] [InnoDB] DDL log recovery : end 2025-11-10T11:46:32.211934+08:00 0 [Note] [MY-011946] [InnoDB] Loading buffer pool(s) from /var/lib/mysql/ib_buffer_pool 2025-11-10T11:46:32.223853+08:00 0 [Note] [MY-012922] [InnoDB] Waiting for purge to start 2025-11-10T11:46:32.234168+08:00 0 [Note] [MY-011946] [InnoDB] Buffer pool(s) load completed at 251110 11:46:32 2025-11-10T11:46:32.288420+08:00 0 [Note] [MY-010303] [Server] Skipping generation of SSL certificates as options related to SSL are specified. 2025-11-10T11:46:32.289195+08:00 0 [Warning] [MY-010068] [Server] CA certificate /etc/mysql/ssl/ca-cert.pem is self signed. 2025-11-10T11:46:32.289253+08:00 0 [System] [MY-013602] [Server] Channel mysql_main configured to support TLS. Encrypted connections are now supported for this channel. 2025-11-10T11:46:32.289486+08:00 0 [Note] [MY-010308] [Server] Skipping generation of RSA key pair through --sha256_password_auto_generate_rsa_keys as key files are present in data directory. 2025-11-10T11:46:32.289681+08:00 0 [Note] [MY-010307] [Server] Skipping generation of RSA key pair through --caching_sha2_password_auto_generate_rsa_keys as options related to RSA keys are specified. 2025-11-10T11:46:32.289844+08:00 0 [Note] [MY-010252] [Server] Server hostname (bind-address): \u0026#39;*\u0026#39;; port: 3306 2025-11-10T11:46:32.289911+08:00 0 [Note] [MY-010253] [Server] IPv6 is available. 2025-11-10T11:46:32.289931+08:00 0 [Note] [MY-010264] [Server] - \u0026#39;::\u0026#39; resolves to \u0026#39;::\u0026#39;; 2025-11-10T11:46:32.289955+08:00 0 [Note] [MY-010251] [Server] Server socket created on IP: \u0026#39;::\u0026#39;. 2025-11-10T11:46:32.291909+08:00 0 [Note] [MY-013930] [Server] systemd notify: STATUS=Components initialization in progress 2025-11-10T11:46:32.292734+08:00 0 [Note] [MY-013930] [Server] systemd notify: STATUS=Components initialization successful 2025-11-10T11:46:32.324976+08:00 0 [Note] [MY-011025] [Repl] Failed to start replica threads for channel \u0026#39;\u0026#39;. 2025-11-10T11:46:32.328585+08:00 6 [Note] [MY-010051] [Server] Event Scheduler: scheduler thread started with id 6 2025-11-10T11:46:32.328860+08:00 0 [Note] [MY-011240] [Server] Plugin mysqlx reported: \u0026#39;Using SSL configuration from MySQL Server\u0026#39; 2025-11-10T11:46:32.329288+08:00 0 [Note] [MY-011243] [Server] Plugin mysqlx reported: \u0026#39;Using OpenSSL for TLS connections\u0026#39; 2025-11-10T11:46:32.329498+08:00 0 [System] [MY-010931] [Server] /usr/sbin/mysqld: ready for connections. Version: \u0026#39;8.4.6-6\u0026#39; socket: \u0026#39;/var/lib/mysql/mysql.sock\u0026#39; port: 3306 Percona Server (GPL), Release 6, Revision 9927a2fb. 2025-11-10T11:46:32.329500+08:00 0 [System] [MY-011323] [Server] X Plugin ready for connections. Bind-address: \u0026#39;::\u0026#39; port: 33060, socket: /var/lib/mysql/mysqlx.sock 2025-11-10T11:46:32.330079+08:00 0 [Note] [MY-013930] [Server] systemd notify: READY=1 STATUS=Server is operational MAIN_PID=14556 MySQL 8.0 #2025-11-10T13:59:10.992215+08:00 0 [Warning] [MY-010097] [Server] Insecure configuration for --secure-log-path: Current value does not restrict location of generated files. Consider setting it to a valid, non-empty path. 2025-11-10T13:59:10.992267+08:00 0 [Warning] [MY-010918] [Server] \u0026#39;default_authentication_plugin\u0026#39; is deprecated and will be removed in a future release. Please use authentication_policy instead. 2025-11-10T13:59:10.992270+08:00 0 [Note] [MY-013932] [Server] BuildID[sha1]=828db7db80124cd9a47f09b8a4a6dc29ead7ca38 2025-11-10T13:59:10.992277+08:00 0 [Note] [MY-010949] [Server] Basedir set to /usr/. 2025-11-10T13:59:10.992284+08:00 0 [System] [MY-010116] [Server] /usr/sbin/mysqld (mysqld 8.0.33-25) starting as process 5191 2025-11-10T13:59:10.996222+08:00 0 [Note] [MY-012366] [InnoDB] Using Linux native AIO 2025-11-10T13:59:10.996308+08:00 0 [Warning] [MY-012367] [InnoDB] Option innodb_dedicated_server is ignored for innodb_flush_methodbecause innodb_flush_method=O_DIRECT is specified explicitly. 2025-11-10T13:59:10.996328+08:00 0 [Warning] [MY-012358] [InnoDB] Option innodb_dedicated_server is ignored for innodb_buffer_pool_size because innodb_buffer_pool_size=3221225472 is specified explicitly. 2025-11-10T13:59:10.996463+08:00 0 [Note] [MY-010747] [Server] Plugin \u0026#39;FEDERATED\u0026#39; is disabled. 2025-11-10T13:59:10.996528+08:00 0 [Note] [MY-010747] [Server] Plugin \u0026#39;ndbcluster\u0026#39; is disabled. 2025-11-10T13:59:10.996545+08:00 0 [Note] [MY-010747] [Server] Plugin \u0026#39;ndbinfo\u0026#39; is disabled. 2025-11-10T13:59:10.996553+08:00 0 [Note] [MY-010747] [Server] Plugin \u0026#39;ndb_transid_mysql_connection_map\u0026#39; is disabled. 2025-11-10T13:59:10.997768+08:00 1 [System] [MY-013576] [InnoDB] InnoDB initialization has started. 2025-11-10T13:59:10.997827+08:00 1 [Note] [MY-013547] [InnoDB] Atomic write disabled 2025-11-10T13:59:10.997860+08:00 1 [Note] [MY-012932] [InnoDB] PUNCH HOLE support available 2025-11-10T13:59:10.997879+08:00 1 [Note] [MY-012944] [InnoDB] Uses event mutexes 2025-11-10T13:59:10.997886+08:00 1 [Note] [MY-012945] [InnoDB] GCC builtin __atomic_thread_fence() is used for memory barrier 2025-11-10T13:59:10.997900+08:00 1 [Note] [MY-012948] [InnoDB] Compressed tables use zlib 1.2.13 2025-11-10T13:59:11.000847+08:00 1 [Note] [MY-012951] [InnoDB] Using hardware accelerated crc32 and polynomial multiplication. 2025-11-10T13:59:11.001216+08:00 1 [Note] [MY-012203] [InnoDB] Directories to scan \u0026#39;./\u0026#39; 2025-11-10T13:59:11.001259+08:00 1 [Note] [MY-012204] [InnoDB] Scanning \u0026#39;./\u0026#39; 2025-11-10T13:59:11.041387+08:00 1 [Note] [MY-012208] [InnoDB] Completed space ID check of 5 files. 2025-11-10T13:59:11.042588+08:00 1 [Note] [MY-012955] [InnoDB] Initializing buffer pool, total size = 3.000000G, instances = 2, chunk size =128.000000M 2025-11-10T13:59:11.128997+08:00 1 [Note] [MY-012957] [InnoDB] Completed initialization of buffer pool 2025-11-10T13:59:11.164980+08:00 0 [Note] [MY-011952] [InnoDB] If the mysqld execution user is authorized, page cleaner and LRU manager thread priority can be changed. See the man page of setpriority(). 2025-11-10T13:59:11.279900+08:00 1 [Note] [MY-013883] [InnoDB] The latest found checkpoint is at lsn = 32109818 in redo log file ./#innodb_redo/#ib_redo0. 2025-11-10T13:59:11.279993+08:00 1 [Note] [MY-013086] [InnoDB] Starting to parse redo log at lsn = 32109600, whereas checkpoint_lsn = 32109818 and start_lsn = 32109568 2025-11-10T13:59:11.311059+08:00 1 [Note] [MY-013083] [InnoDB] Log background threads are being started... 2025-11-10T13:59:11.416434+08:00 1 [Note] [MY-012532] [InnoDB] Applying a batch of 0 redo log records ... 2025-11-10T13:59:11.416495+08:00 1 [Note] [MY-012535] [InnoDB] Apply batch completed! 2025-11-10T13:59:11.417728+08:00 1 [Note] [MY-013252] [InnoDB] Using undo tablespace \u0026#39;./undo_001\u0026#39;. 2025-11-10T13:59:11.444628+08:00 1 [Note] [MY-013252] [InnoDB] Using undo tablespace \u0026#39;./undo_002\u0026#39;. 2025-11-10T13:59:11.450696+08:00 1 [Note] [MY-012910] [InnoDB] Opened 2 existing undo tablespaces. 2025-11-10T13:59:11.450745+08:00 1 [Note] [MY-011980] [InnoDB] GTID recovery trx_no: 2065 2025-11-10T13:59:12.022381+08:00 1 [Note] [MY-013776] [InnoDB] Parallel initialization of rseg complete 2025-11-10T13:59:12.022448+08:00 1 [Note] [MY-013777] [InnoDB] Time taken to initialize rseg using 2 thread: 571710 ms. 2025-11-10T13:59:12.022538+08:00 1 [Note] [MY-012923] [InnoDB] Creating shared tablespace for temporary tables 2025-11-10T13:59:12.022640+08:00 1 [Note] [MY-012265] [InnoDB] Setting file \u0026#39;/var/lib/mysql/ibtmp1\u0026#39; size to 12 MB. Physically writing the file full; Please wait ... 2025-11-10T13:59:12.057665+08:00 1 [Note] [MY-012266] [InnoDB] File \u0026#39;/var/lib/mysql/ibtmp1\u0026#39; size is now 12 MB. 2025-11-10T13:59:12.057770+08:00 1 [Note] [MY-013627] [InnoDB] Scanning temp tablespace dir:\u0026#39;./#innodb_temp/\u0026#39; 2025-11-10T13:59:12.069806+08:00 1 [Note] [MY-013018] [InnoDB] Created 128 and tracked 128 new rollback segment(s) in the temporary tablespace. 128 are now active. 2025-11-10T13:59:12.077433+08:00 1 [Note] [MY-012976] [InnoDB] Percona XtraDB (http://www.percona.com) 8.0.33-25 started; log sequence number 32109828 2025-11-10T13:59:12.078046+08:00 1 [System] [MY-013577] [InnoDB] InnoDB initialization has ended. 2025-11-10T13:59:12.086557+08:00 1 [Note] [MY-011089] [Server] Data dictionary restarting version \u0026#39;80023\u0026#39;. 2025-11-10T13:59:12.281069+08:00 1 [Note] [MY-012357] [InnoDB] Reading DD tablespace files 2025-11-10T13:59:12.281617+08:00 1 [Note] [MY-012356] [InnoDB] Scanned 7 tablespaces. Validated 7. 2025-11-10T13:59:12.302157+08:00 1 [Note] [MY-010006] [Server] Using data dictionary with version \u0026#39;80023\u0026#39;. 2025-11-10T13:59:12.308733+08:00 0 [Note] [MY-011332] [Server] Plugin mysqlx reported: \u0026#39;IPv6 is available\u0026#39; 2025-11-10T13:59:12.309917+08:00 0 [Note] [MY-011323] [Server] Plugin mysqlx reported: \u0026#39;X Plugin ready for connections. bind-address: \u0026#39;::\u0026#39; port: 33060\u0026#39; 2025-11-10T13:59:12.309944+08:00 0 [Note] [MY-011323] [Server] Plugin mysqlx reported: \u0026#39;X Plugin ready for connections. socket: \u0026#39;/var/lib/mysql/mysqlx.sock\u0026#39;\u0026#39; 2025-11-10T13:59:12.330315+08:00 0 [Note] [MY-010902] [Server] Thread priority attribute setting in Resource Group SQL shall be ignored due to unsupported platform or insufficient privilege. 2025-11-10T13:59:12.334603+08:00 0 [Note] [MY-010856] [Server] Failed to open the crashed binlog file when source server is recovering it. 2025-11-10T13:59:12.343184+08:00 0 [Note] [MY-013911] [Server] Crash recovery finished in binlog engine. No attempts to commit, rollback or prepare any transactions. 2025-11-10T13:59:12.343214+08:00 0 [Note] [MY-013911] [Server] Crash recovery finished in InnoDB engine. No attempts to commit, rollback or prepare any transactions. 2025-11-10T13:59:12.345475+08:00 0 [Note] [MY-012487] [InnoDB] DDL log recovery : begin 2025-11-10T13:59:12.346228+08:00 0 [Note] [MY-012488] [InnoDB] DDL log recovery : end 2025-11-10T13:59:12.350893+08:00 0 [Note] [MY-011946] [InnoDB] Loading buffer pool(s) from /var/lib/mysql/ib_buffer_pool 2025-11-10T13:59:12.351226+08:00 0 [Note] [MY-011946] [InnoDB] Buffer pool(s) load completed at 251110 13:59:12 2025-11-10T13:59:12.375527+08:00 0 [Note] [MY-010303] [Server] Skipping generation of SSL certificates as options related to SSL are specified. 2025-11-10T13:59:12.376332+08:00 0 [Warning] [MY-010068] [Server] CA certificate /etc/mysql/ssl/ca-cert.pem is self signed. 2025-11-10T13:59:12.376367+08:00 0 [System] [MY-013602] [Server] Channel mysql_main configured to support TLS. Encrypted connections are now supported for this channel. 2025-11-10T13:59:12.376552+08:00 0 [Note] [MY-010308] [Server] Skipping generation of RSA key pair through --sha256_password_auto_generate_rsa_keys as key files are present in data directory. 2025-11-10T13:59:12.376710+08:00 0 [Note] [MY-010308] [Server] Skipping generation of RSA key pair through --caching_sha2_password_auto_generate_rsa_keys as key files are present in data directory. 2025-11-10T13:59:12.376832+08:00 0 [Note] [MY-010252] [Server] Server hostname (bind-address): \u0026#39;*\u0026#39;; port: 3306 2025-11-10T13:59:12.376879+08:00 0 [Note] [MY-010253] [Server] IPv6 is available. 2025-11-10T13:59:12.376894+08:00 0 [Note] [MY-010264] [Server] - \u0026#39;::\u0026#39; resolves to \u0026#39;::\u0026#39;; 2025-11-10T13:59:12.376909+08:00 0 [Note] [MY-010251] [Server] Server socket created on IP: \u0026#39;::\u0026#39;. 2025-11-10T13:59:12.411001+08:00 0 [Note] [MY-011025] [Repl] Failed to start replica threads for channel \u0026#39;\u0026#39;. 2025-11-10T13:59:12.414065+08:00 5 [Note] [MY-010051] [Server] Event Scheduler: scheduler thread started with id 5 2025-11-10T13:59:12.414293+08:00 0 [Note] [MY-011240] [Server] Plugin mysqlx reported: \u0026#39;Using SSL configuration from MySQL Server\u0026#39; 2025-11-10T13:59:12.414852+08:00 0 [Note] [MY-011243] [Server] Plugin mysqlx reported: \u0026#39;Using OpenSSL for TLS connections\u0026#39; 2025-11-10T13:59:12.415018+08:00 0 [System] [MY-010931] [Server] /usr/sbin/mysqld: ready for connections. Version: \u0026#39;8.0.33-25\u0026#39; socket: \u0026#39;/var/lib/mysql/mysql.sock\u0026#39; port: 3306 Percona Server (GPL), Release 25, Revision 60c9e2c5. 2025-11-10T13:59:12.418069+08:00 0 [System] [MY-011323] [Server] X Plugin ready for connections. Bind-address: \u0026#39;::\u0026#39; port: 33060, socket: /var/lib/mysql/mysqlx.sock Â∑ÆÁï∞Èªû # # MySQL 8.4 [Server] systemd notify: STATUS=InnoDB initialization successful [Server] Data dictionary restarting version \u0026#39;80300\u0026#39;. [Server] systemd notify: STATUS=InnoDB crash recovery in progress [InnoDB] Reading DD tablespace files [InnoDB] Scanned 8 tablespaces. Validated 8. [Server] systemd notify: STATUS=InnoDB crash recovery successful # MySQL 8.0 [Server] Data dictionary restarting version \u0026#39;80023\u0026#39;. [InnoDB] Reading DD tablespace files [InnoDB] Scanned 7 tablespaces. Validated 7. È°û‰ºº‰∏äËø∞ÈÄôÊ®£ÔºåÂ§ö‰∫Ü‰∏Ä‰∫õ [Server] Status\nÂú®Âá∫ÁèæÂïèÈ°åÊôÇÔºåÂèØ‰ª•Êõ¥Âä†ÊòéÁ¢∫ÁöÑÁü•ÈÅìÊòØÂú®Âì™‰∏ÄÊ≠•È©üÂá∫ÁèæÈåØË™§\nShutdown #MySQL 8.4 #2025-11-10T11:46:24.969675+08:00 0 [System] [MY-013172] [Server] Received SHUTDOWN from user \u0026lt;via user signal\u0026gt;. Shutting down mysqld (Version: 8.4.6-6). 2025-11-10T11:46:24.970821+08:00 0 [Note] [MY-013930] [Server] systemd notify: STOPPING=1 STATUS=Server shutdown in progress 2025-11-10T11:46:24.975792+08:00 0 [Note] [MY-015023] [Server] MySQL Server: Closing Connections - start. 2025-11-10T11:46:24.975924+08:00 0 [Note] [MY-013930] [Server] systemd notify: STATUS=Graceful shutdown of connections in progress 2025-11-10T11:46:24.976468+08:00 0 [Note] [MY-010067] [Server] Giving 3 client threads a chance to die gracefully 2025-11-10T11:46:24.976524+08:00 0 [Note] [MY-010117] [Server] Shutting down replica threads 2025-11-10T11:46:24.976551+08:00 0 [Note] [MY-013930] [Server] systemd notify: STATUS=Shutdown of replica threads in progress 2025-11-10T11:46:24.976579+08:00 0 [Note] [MY-010054] [Server] Event Scheduler: Killing the scheduler thread, thread id 6 2025-11-10T11:46:24.976603+08:00 0 [Note] [MY-010050] [Server] Event Scheduler: Waiting for the scheduler thread to reply 2025-11-10T11:46:24.976929+08:00 0 [Note] [MY-010048] [Server] Event Scheduler: Stopped 2025-11-10T11:46:26.977108+08:00 0 [Note] [MY-010118] [Server] Forcefully disconnecting 1 remaining clients 2025-11-10T11:46:26.977241+08:00 0 [Note] [MY-013930] [Server] systemd notify: STATUS=Forceful shutdown of connections in progress 2025-11-10T11:46:26.977279+08:00 0 [Warning] [MY-010909] [Server] /usr/sbin/mysqld: Forcing close of thread 927 user: \u0026#39;xxxxx\u0026#39;. 2025-11-10T11:46:26.977406+08:00 0 [Note] [MY-010043] [Server] Event Scheduler: Purging the queue. 0 events 2025-11-10T11:46:26.977441+08:00 0 [Note] [MY-015026] [Server] Waiting for forceful disconnection of 1 thread(s) to end. 2025-11-10T11:46:26.977469+08:00 0 [Note] [MY-014072] [Server] Waiting for THDs in partition 7 to be closed, 1 still left. 1 THDs left in total for all partitions. 2025-11-10T11:46:26.978294+08:00 0 [Note] [MY-015024] [Server] MySQL Server: Closing Connections - end. 2025-11-10T11:46:26.978349+08:00 0 [Note] [MY-013930] [Server] systemd notify: STATUS=Connection shutdown complete 2025-11-10T11:46:26.978491+08:00 0 [Note] [MY-013930] [Server] systemd notify: STATUS=Pre DD shutdown of MySQL SE plugin InnoDB in progress 2025-11-10T11:46:26.979665+08:00 0 [Note] [MY-012330] [InnoDB] FTS optimize thread exiting. 2025-11-10T11:46:27.829786+08:00 0 [Note] [MY-013930] [Server] systemd notify: STATUS=Pre DD shutdown of MySQL SE plugin InnoDB completed 2025-11-10T11:46:27.831654+08:00 0 [Note] [MY-010120] [Server] Binlog end 2025-11-10T11:46:27.834907+08:00 0 [Note] [MY-015019] [Server] MySQL Server: Plugins Shutdown - start. 2025-11-10T11:46:27.834976+08:00 0 [Note] [MY-013930] [Server] systemd notify: STATUS=Shutdown of plugins in progress 2025-11-10T11:46:27.835010+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;mysqlx\u0026#39; 2025-11-10T11:46:27.836708+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;mysqlx_cache_cleaner\u0026#39; 2025-11-10T11:46:27.836771+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;ngram\u0026#39; 2025-11-10T11:46:27.836796+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;BLACKHOLE\u0026#39; 2025-11-10T11:46:27.836839+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;ARCHIVE\u0026#39; 2025-11-10T11:46:27.836857+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;TempTable\u0026#39; 2025-11-10T11:46:27.836874+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;MRG_MYISAM\u0026#39; 2025-11-10T11:46:27.836892+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;MyISAM\u0026#39; 2025-11-10T11:46:27.836919+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_SESSION_TEMP_TABLESPACES\u0026#39; 2025-11-10T11:46:27.836938+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_CACHED_INDEXES\u0026#39; 2025-11-10T11:46:27.836955+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_VIRTUAL\u0026#39; 2025-11-10T11:46:27.836974+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_COLUMNS\u0026#39; 2025-11-10T11:46:27.836992+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_TABLESPACES\u0026#39; 2025-11-10T11:46:27.837012+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_INDEXES\u0026#39; 2025-11-10T11:46:27.837030+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_TABLESTATS\u0026#39; 2025-11-10T11:46:27.837052+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_TABLES\u0026#39; 2025-11-10T11:46:27.837070+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_FT_INDEX_TABLE\u0026#39; 2025-11-10T11:46:27.837086+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_FT_INDEX_CACHE\u0026#39; 2025-11-10T11:46:27.837103+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_FT_CONFIG\u0026#39; 2025-11-10T11:46:27.837120+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_FT_BEING_DELETED\u0026#39; 2025-11-10T11:46:27.837137+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_FT_DELETED\u0026#39; 2025-11-10T11:46:27.837154+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_FT_DEFAULT_STOPWORD\u0026#39; 2025-11-10T11:46:27.837170+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_METRICS\u0026#39; 2025-11-10T11:46:27.837189+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_TEMP_TABLE_INFO\u0026#39; 2025-11-10T11:46:27.837207+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_BUFFER_POOL_STATS\u0026#39; 2025-11-10T11:46:27.837224+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_BUFFER_PAGE_LRU\u0026#39; 2025-11-10T11:46:27.837241+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_BUFFER_PAGE\u0026#39; 2025-11-10T11:46:27.837260+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_CMP_PER_INDEX_RESET\u0026#39; 2025-11-10T11:46:27.837278+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_CMP_PER_INDEX\u0026#39; 2025-11-10T11:46:27.837295+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_CMPMEM_RESET\u0026#39; 2025-11-10T11:46:27.837312+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_CMPMEM\u0026#39; 2025-11-10T11:46:27.837329+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_CMP_RESET\u0026#39; 2025-11-10T11:46:27.837345+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_CMP\u0026#39; 2025-11-10T11:46:27.837362+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_TRX\u0026#39; 2025-11-10T11:46:27.837383+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;InnoDB\u0026#39; 2025-11-10T11:46:27.837426+08:00 0 [Note] [MY-013072] [InnoDB] Starting shutdown... 2025-11-10T11:46:27.837574+08:00 0 [Note] [MY-011944] [InnoDB] Dumping buffer pool(s) to /var/lib/mysql/ib_buffer_pool 2025-11-10T11:46:27.837859+08:00 0 [Note] [MY-011944] [InnoDB] Buffer pool(s) dump completed at 251110 11:46:27 2025-11-10T11:46:27.841758+08:00 0 [Note] [MY-013084] [InnoDB] Log background threads are being closed... 2025-11-10T11:46:28.766453+08:00 0 [Note] [MY-013854] [InnoDB] Bytes written to disk by DBLWR (ON): 819200 2025-11-10T11:46:28.767553+08:00 0 [Note] [MY-012980] [InnoDB] Shutdown completed; log sequence number 30303787 2025-11-10T11:46:28.768904+08:00 0 [Note] [MY-012255] [InnoDB] Removed temporary tablespace data file: \u0026#34;ibtmp1\u0026#34; 2025-11-10T11:46:28.768969+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;MEMORY\u0026#39; 2025-11-10T11:46:28.768999+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;CSV\u0026#39; 2025-11-10T11:46:28.769022+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;PERFORMANCE_SCHEMA\u0026#39; 2025-11-10T11:46:28.769062+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;daemon_keyring_proxy_plugin\u0026#39; 2025-11-10T11:46:28.769092+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;sha2_cache_cleaner\u0026#39; 2025-11-10T11:46:28.769114+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;caching_sha2_password\u0026#39; 2025-11-10T11:46:28.769135+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;sha256_password\u0026#39; 2025-11-10T11:46:28.769285+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;binlog\u0026#39; 2025-11-10T11:46:28.769312+08:00 0 [Note] [MY-015020] [Server] MySQL Server: Plugins Shutdown - end. 2025-11-10T11:46:28.769337+08:00 0 [Note] [MY-013930] [Server] systemd notify: STATUS=Shutdown of plugins complete 2025-11-10T11:46:28.773283+08:00 0 [Note] [MY-015021] [Server] MySQL Server: Components Shutdown - start. 2025-11-10T11:46:28.773313+08:00 0 [Note] [MY-013930] [Server] systemd notify: Shutdown of components in progress 2025-11-10T11:46:28.773922+08:00 0 [Note] [MY-015022] [Server] MySQL Server: Components Shutdown - end (with return value = 0). 2025-11-10T11:46:28.773944+08:00 0 [Note] [MY-013930] [Server] systemd notify: Shutdown of components successful 2025-11-10T11:46:28.774059+08:00 0 [Note] [MY-013930] [Server] systemd notify: STATUS=Server shutdown complete (with return value = 0) 2025-11-10T11:46:28.774075+08:00 0 [System] [MY-010910] [Server] /usr/sbin/mysqld: Shutdown complete (mysqld 8.4.6-6) Percona Server (GPL), Release 6, Revision 9927a2fb. 2025-11-10T11:46:28.774082+08:00 0 [System] [MY-015016] [Server] MySQL Server - end. MySQL 8.0 #2025-11-10T13:59:07.831656+08:00 0 [System] [MY-013172] [Server] Received SHUTDOWN from user \u0026lt;via user signal\u0026gt;. Shutting down mysqld (Version: 8.0.33-25). 2025-11-10T13:59:07.834106+08:00 0 [Note] [MY-010067] [Server] Giving 2 client threads a chance to die gracefully 2025-11-10T13:59:07.834134+08:00 0 [Note] [MY-010117] [Server] Shutting down replica threads 2025-11-10T13:59:07.834147+08:00 0 [Note] [MY-010054] [Server] Event Scheduler: Killing the scheduler thread, thread id 5 2025-11-10T13:59:07.834161+08:00 0 [Note] [MY-010050] [Server] Event Scheduler: Waiting for the scheduler thread to reply 2025-11-10T13:59:07.834235+08:00 0 [Note] [MY-010048] [Server] Event Scheduler: Stopped 2025-11-10T13:59:09.834325+08:00 0 [Note] [MY-010118] [Server] Forcefully disconnecting 0 remaining clients 2025-11-10T13:59:09.834389+08:00 0 [Note] [MY-010043] [Server] Event Scheduler: Purging the queue. 0 events 2025-11-10T13:59:09.835670+08:00 0 [Note] [MY-012330] [InnoDB] FTS optimize thread exiting. 2025-11-10T13:59:09.939724+08:00 0 [Note] [MY-010120] [Server] Binlog end 2025-11-10T13:59:09.941776+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;mysqlx\u0026#39; 2025-11-10T13:59:09.942705+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;mysqlx_cache_cleaner\u0026#39; 2025-11-10T13:59:09.942734+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;ngram\u0026#39; 2025-11-10T13:59:09.942743+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;BLACKHOLE\u0026#39; 2025-11-10T13:59:09.942750+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;ARCHIVE\u0026#39; 2025-11-10T13:59:09.942757+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;TempTable\u0026#39; 2025-11-10T13:59:09.942762+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;MRG_MYISAM\u0026#39; 2025-11-10T13:59:09.942769+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;MyISAM\u0026#39; 2025-11-10T13:59:09.942787+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_SESSION_TEMP_TABLESPACES\u0026#39; 2025-11-10T13:59:09.942836+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_CACHED_INDEXES\u0026#39; 2025-11-10T13:59:09.942846+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_VIRTUAL\u0026#39; 2025-11-10T13:59:09.942853+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_COLUMNS\u0026#39; 2025-11-10T13:59:09.942859+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_TABLESPACES\u0026#39; 2025-11-10T13:59:09.942865+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_INDEXES\u0026#39; 2025-11-10T13:59:09.942871+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_TABLESTATS\u0026#39; 2025-11-10T13:59:09.942877+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_TABLES\u0026#39; 2025-11-10T13:59:09.942890+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_FT_INDEX_TABLE\u0026#39; 2025-11-10T13:59:09.942897+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_FT_INDEX_CACHE\u0026#39; 2025-11-10T13:59:09.942904+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_FT_CONFIG\u0026#39; 2025-11-10T13:59:09.942910+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_FT_BEING_DELETED\u0026#39; 2025-11-10T13:59:09.942916+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_FT_DELETED\u0026#39; 2025-11-10T13:59:09.942924+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_FT_DEFAULT_STOPWORD\u0026#39; 2025-11-10T13:59:09.942938+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_METRICS\u0026#39; 2025-11-10T13:59:09.942945+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_TEMP_TABLE_INFO\u0026#39; 2025-11-10T13:59:09.942951+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_BUFFER_POOL_STATS\u0026#39; 2025-11-10T13:59:09.942957+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_BUFFER_PAGE_LRU\u0026#39; 2025-11-10T13:59:09.942962+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_BUFFER_PAGE\u0026#39; 2025-11-10T13:59:09.942969+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_CMP_PER_INDEX_RESET\u0026#39; 2025-11-10T13:59:09.942975+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_CMP_PER_INDEX\u0026#39; 2025-11-10T13:59:09.942981+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_CMPMEM_RESET\u0026#39; 2025-11-10T13:59:09.942990+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_CMPMEM\u0026#39; 2025-11-10T13:59:09.942998+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_CMP_RESET\u0026#39; 2025-11-10T13:59:09.943005+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_CMP\u0026#39; 2025-11-10T13:59:09.943011+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;INNODB_TRX\u0026#39; 2025-11-10T13:59:09.943017+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;InnoDB\u0026#39; 2025-11-10T13:59:09.943044+08:00 0 [Note] [MY-013072] [InnoDB] Starting shutdown... 2025-11-10T13:59:09.943151+08:00 0 [Note] [MY-011944] [InnoDB] Dumping buffer pool(s) to /var/lib/mysql/ib_buffer_pool 2025-11-10T13:59:09.943401+08:00 0 [Note] [MY-011944] [InnoDB] Buffer pool(s) dump completed at 251110 13:59:09 2025-11-10T13:59:10.149053+08:00 0 [Note] [MY-013084] [InnoDB] Log background threads are being closed... 2025-11-10T13:59:10.666371+08:00 0 [Note] [MY-012980] [InnoDB] Shutdown completed; log sequence number 32109818 2025-11-10T13:59:10.666498+08:00 0 [Note] [MY-012255] [InnoDB] Removed temporary tablespace data file: \u0026#34;ibtmp1\u0026#34; 2025-11-10T13:59:10.666528+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;MEMORY\u0026#39; 2025-11-10T13:59:10.666541+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;CSV\u0026#39; 2025-11-10T13:59:10.666551+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;PERFORMANCE_SCHEMA\u0026#39; 2025-11-10T13:59:10.666577+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;daemon_keyring_proxy_plugin\u0026#39; 2025-11-10T13:59:10.666592+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;sha2_cache_cleaner\u0026#39; 2025-11-10T13:59:10.666602+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;caching_sha2_password\u0026#39; 2025-11-10T13:59:10.666612+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;sha256_password\u0026#39; 2025-11-10T13:59:10.666618+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;mysql_native_password\u0026#39; 2025-11-10T13:59:10.666748+08:00 0 [Note] [MY-010733] [Server] Shutting down plugin \u0026#39;binlog\u0026#39; 2025-11-10T13:59:10.667428+08:00 0 [System] [MY-010910] [Server] /usr/sbin/mysqld: Shutdown complete (mysqld 8.0.33-25) Percona Server (GPL), Release 25, Revision 60c9e2c5. Â∑ÆÁï∞Èªû # # MySQL 8.4 [Warning] [MY-010909] [Server] /usr/sbin/mysqld: Forcing close of thread 927 user: \u0026#39;xxxxx\u0026#39;. # MySQL 8.0 None Ë∑ü Startup È°û‰ººÔºå‰πüÊòØÂ§ö‰∫Ü‰∏Ä‰∫õ [Server Status]\nÊØîËºÉÁâπÂà•‰∏îÊúâÁî®ÁöÑÂú∞ÊñπÂú®ÊñºÔºåShutdown ÊúâÂ§ö‰∫ÜÈÄ£Á∑öË¢´ÈóúÈñâÁöÑË≥áË®äÔºå\nÈÄôÂú®ÊéíÊü•‰∏Ä‰∫õÂïèÈ°åÊàñË®±ÂèØ‰ª•Â∏∂‰æÜ‰∏Ä‰∫õÂπ´Âä©„ÄÇ\nÊØîÂ¶ÇË™™Êúâ Client ÂèçÊáâÈÄ£Á∑öÂá∫ÁèæÈåØË™§Ôºå‰ΩÜÊòéÊòéÂ∑≤Á∂ìÂæû Connection Pool ‰∏≠ÁßªÈô§‰∫ÜÔºå\nÁï∂‰∏ã‰πüÂè™ÊúâÊääÊ©üÂô®ÈáçÂïüÔºåÈÄôÊôÇÂ∞±ÂèØ‰ª•ÁúãÁúã Error Log ‰∏≠ÊòØ‰∏çÊòØÊúâÈÄ£Á∑öÊ≤íÊúâÁßªÈô§‰πæÊ∑®Ôºå\nÂ∞éËá¥ÈÄ£Á∑öÈÇÑÊòØË¢´ÈÄÅÂà∞ÈÄôÂè∞Ê©üÂô®ËÄåÂΩ±ÈüøÂà∞\nAfterword #Áï∂ÂàùÊ®ôË®òÁÇ∫ ‚≠ê ÁöÑÂéüÂõ†ÊòØÊÉ≥‰∫ÜËß£ filter ‰ª•Âèä sink ÁöÑÂäüËÉΩÔºå\nÂæå‰æÜÁôºÁèæÈÄôÂÖ∂ÂØ¶Âú® MySQL 8.0 Â∞±Â∑≤Á∂ìÊúâ‰∫Ü\nWL #9323 -\u0026gt; Logging services: Improved error logging in 8.0\nMySQL 8.0 Release Note: Error logging was rewritten to use the MySQL component architecture\nÁï∂Âàù MySQL 8.0 ÊôÇÊ≤íÊúâÁïôÊÑèÂà∞ÈÄôÂäüËÉΩÔºå\nÂà∞‰∫Ü MySQL 8.4 ÊôÇÊâç‰æÜÁÜüÊÇâÂÆÉÔºå\n‰πüÂõ†ÁÇ∫ÈÄôÂäüËÉΩË∑ü 8.4 Ê≤íÊúâÂ§™Â§ßÈóú‰øÇÔºå\nÊâÄ‰ª•ÁúãÂÆåÂæåÂ∞±ÈªòÈªòÂú∞ÊääÂÆÉÁßªÈô§ ‚≠ê Âõâ„ÄÇ\nÊÑüÊÉ≥ÈõñÁÑ∂ÊòØ ÊúâÁî®Ôºå‰ΩÜ‰∏çÂ§ö\n‰∏ªË¶ÅÁöÑÂéüÂõ†ÊòØÂõ†ÁÇ∫ÊàëÂÄëÂ§™ÊôöÁü•ÈÅìÈÄôÂäüËÉΩÔºå\nÊàëÂÄëÁõÆÂâçÊòØ‰ΩøÁî® Loki ÁöÑÊñπÂºè‰æÜÊî∂ Error LogÔºå\nÂ¶ÇÊûúÊó©ÈªûÁü•ÈÅìÈÄôÂäüËÉΩÁöÑË©±Ôºå\nÁï∂ÂàùÁöÑÊ±∫Á≠ñÂ∞±ÊúÉÊòØ‰ΩøÁî® log_sink_json ÁöÑÊñπÂºè‰æÜÂÑ≤Â≠ò Error LogÔºå\nÈÄôÂ∞çÂæåÈù¢ÁöÑÁ≥ªÁµ±‰∏≤Êé•ÂèØ‰ª•Â∏∂‰æÜÂæàÂ§ßÁöÑ‰æøÂà©ÊÄß„ÄÇ\nÁõÆÂâçÊòØ‰ΩøÁî® LogQL Â≠ó‰∏≤ÊØîÂ∞çÁöÑÊñπÂºè‰æÜÂÅµÊ∏¨‰∏¶ÁôºÈÄÅÂëäË≠¶Ôºå\nÂëäË≠¶ÁöÑÁ®ÆÈ°ûÁõÆÂâçÊúâ‰ª•‰∏ãÂπæÁ®Æ\nToo Many Connections Dead Lock ERROR Log Too Many Connection # Loki expr: count_over_time({type=\u0026ldquo;mysql/errorlog\u0026rdquo;} |= \u0026ldquo;Too many connections\u0026rdquo; [1m])\nÂÅáÂ¶Ç‰ΩøÁî® log_sink_json ÁöÑË©±ÔºåError Log ÁöÑË≥áË®äÂ¶Ç‰∏ã\n{ \u0026#34;prio\u0026#34;: 2, \u0026#34;source_line\u0026#34;: 282, \u0026#34;source_file\u0026#34;: \u0026#34;connection_handler_manager.cc\u0026#34;, \u0026#34;msg\u0026#34;: \u0026#34;Too many connections\u0026#34;, \u0026#34;time\u0026#34;: \u0026#34;2025-11-10T09:39:22.188365+08:00\u0026#34;, \u0026#34;ts\u0026#34;: 1762738762188, \u0026#34;subsystem\u0026#34;: \u0026#34;Server\u0026#34;, \u0026#34;label\u0026#34;: \u0026#34;Warning\u0026#34; } Dead Lock # Loki expr: count_over_time({type=\u0026ldquo;mysql/errorlog\u0026rdquo;} |= \u0026ldquo;deadlock\u0026rdquo; [1m])\nlog_sink_json Ê†ºÂºè\n{ \u0026#34;log_type\u0026#34;: 1, \u0026#34;prio\u0026#34;: 3, \u0026#34;err_code\u0026#34;: 12468, \u0026#34;subsystem\u0026#34;: \u0026#34;InnoDB\u0026#34;, \u0026#34;msg\u0026#34;: \u0026#34;Transactions deadlock detected, dumping detailed information.\u0026#34;, \u0026#34;time\u0026#34;: \u0026#34;2025-11-10T08:52:25.728726+08:00\u0026#34;, \u0026#34;ts\u0026#34;: 1762735945728, \u0026#34;err_symbol\u0026#34;: \u0026#34;ER_IB_MSG_643\u0026#34;, \u0026#34;SQL_state\u0026#34;: \u0026#34;HY000\u0026#34;, \u0026#34;label\u0026#34;: \u0026#34;Note\u0026#34; } { \u0026#34;log_type\u0026#34;: 1, \u0026#34;prio\u0026#34;: 3, \u0026#34;err_code\u0026#34;: 12469, \u0026#34;subsystem\u0026#34;: \u0026#34;InnoDB\u0026#34;, \u0026#34;msg\u0026#34;: \u0026#34;\\n*** (1) TRANSACTION:\\n\u0026#34;, \u0026#34;time\u0026#34;: \u0026#34;2025-11-10T08:52:25.728850+08:00\u0026#34;, \u0026#34;ts\u0026#34;: 1762735945728, \u0026#34;err_symbol\u0026#34;: \u0026#34;ER_IB_MSG_644\u0026#34;, \u0026#34;SQL_state\u0026#34;: \u0026#34;HY000\u0026#34;, \u0026#34;label\u0026#34;: \u0026#34;Note\u0026#34; } { \u0026#34;log_type\u0026#34;: 1, \u0026#34;prio\u0026#34;: 3, \u0026#34;err_code\u0026#34;: 12469, \u0026#34;subsystem\u0026#34;: \u0026#34;InnoDB\u0026#34;, \u0026#34;msg\u0026#34;: \u0026#34;\\n*** (1) HOLDS THE LOCK(S):\\n\u0026#34;, \u0026#34;time\u0026#34;: \u0026#34;2025-11-10T08:52:25.728929+08:00\u0026#34;, \u0026#34;ts\u0026#34;: 1762735945728, \u0026#34;err_symbol\u0026#34;: \u0026#34;ER_IB_MSG_644\u0026#34;, \u0026#34;SQL_state\u0026#34;: \u0026#34;HY000\u0026#34;, \u0026#34;label\u0026#34;: \u0026#34;Note\u0026#34; } { \u0026#34;log_type\u0026#34;: 1, \u0026#34;prio\u0026#34;: 3, \u0026#34;err_code\u0026#34;: 12469, \u0026#34;subsystem\u0026#34;: \u0026#34;InnoDB\u0026#34;, \u0026#34;msg\u0026#34;: \u0026#34;\\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\\n\u0026#34;, \u0026#34;time\u0026#34;: \u0026#34;2025-11-10T08:52:25.729280+08:00\u0026#34;, \u0026#34;ts\u0026#34;: 1762735945729, \u0026#34;err_symbol\u0026#34;: \u0026#34;ER_IB_MSG_644\u0026#34;, \u0026#34;SQL_state\u0026#34;: \u0026#34;HY000\u0026#34;, \u0026#34;label\u0026#34;: \u0026#34;Note\u0026#34; } { \u0026#34;log_type\u0026#34;: 1, \u0026#34;prio\u0026#34;: 3, \u0026#34;err_code\u0026#34;: 12469, \u0026#34;subsystem\u0026#34;: \u0026#34;InnoDB\u0026#34;, \u0026#34;msg\u0026#34;: \u0026#34;\\n*** (2) TRANSACTION:\\n\u0026#34;, \u0026#34;time\u0026#34;: \u0026#34;2025-11-10T08:52:25.729593+08:00\u0026#34;, \u0026#34;ts\u0026#34;: 1762735945729, \u0026#34;err_symbol\u0026#34;: \u0026#34;ER_IB_MSG_644\u0026#34;, \u0026#34;SQL_state\u0026#34;: \u0026#34;HY000\u0026#34;, \u0026#34;label\u0026#34;: \u0026#34;Note\u0026#34; } { \u0026#34;log_type\u0026#34;: 1, \u0026#34;prio\u0026#34;: 3, \u0026#34;err_code\u0026#34;: 12469, \u0026#34;subsystem\u0026#34;: \u0026#34;InnoDB\u0026#34;, \u0026#34;msg\u0026#34;: \u0026#34;\\n*** (2) HOLDS THE LOCK(S):\\n\u0026#34;, \u0026#34;time\u0026#34;: \u0026#34;2025-11-10T08:52:25.729658+08:00\u0026#34;, \u0026#34;ts\u0026#34;: 1762735945729, \u0026#34;err_symbol\u0026#34;: \u0026#34;ER_IB_MSG_644\u0026#34;, \u0026#34;SQL_state\u0026#34;: \u0026#34;HY000\u0026#34;, \u0026#34;label\u0026#34;: \u0026#34;Note\u0026#34; } { \u0026#34;log_type\u0026#34;: 1, \u0026#34;prio\u0026#34;: 3, \u0026#34;err_code\u0026#34;: 12469, \u0026#34;subsystem\u0026#34;: \u0026#34;InnoDB\u0026#34;, \u0026#34;msg\u0026#34;: \u0026#34;\\n*** (2) WAITING FOR THIS LOCK TO BE GRANTED:\\n\u0026#34;, \u0026#34;time\u0026#34;: \u0026#34;2025-11-10T08:52:25.729972+08:00\u0026#34;, \u0026#34;ts\u0026#34;: 1762735945729, \u0026#34;err_symbol\u0026#34;: \u0026#34;ER_IB_MSG_644\u0026#34;, \u0026#34;SQL_state\u0026#34;: \u0026#34;HY000\u0026#34;, \u0026#34;label\u0026#34;: \u0026#34;Note\u0026#34; } { \u0026#34;log_type\u0026#34;: 1, \u0026#34;prio\u0026#34;: 3, \u0026#34;err_code\u0026#34;: 12469, \u0026#34;subsystem\u0026#34;: \u0026#34;InnoDB\u0026#34;, \u0026#34;msg\u0026#34;: \u0026#34;*** WE ROLL BACK TRANSACTION (2)\\n\u0026#34;, \u0026#34;time\u0026#34;: \u0026#34;2025-11-10T08:52:25.730272+08:00\u0026#34;, \u0026#34;ts\u0026#34;: 1762735945730, \u0026#34;err_symbol\u0026#34;: \u0026#34;ER_IB_MSG_644\u0026#34;, \u0026#34;SQL_state\u0026#34;: \u0026#34;HY000\u0026#34;, \u0026#34;label\u0026#34;: \u0026#34;Note\u0026#34; } log_sink_internal Ê†ºÂºè\n2025-11-10T08:52:25.728726+08:00 0 [Note] [MY-012468] [InnoDB] Transactions deadlock detected, dumping detailed information. 2025-11-10T08:52:25.728850+08:00 0 [Note] [MY-012469] [InnoDB] *** (1) TRANSACTION: TRANSACTION 3109, ACTIVE 25 sec starting index read mysql tables in use 1, locked 1 LOCK WAIT 3 lock struct(s), heap size 1128, 2 row lock(s), undo log entries 1 MySQL thread id 2243, OS thread handle 140566786410240, query id 16117 localhost hilife_db updating update t set name = \u0026#39;YangPlus\u0026#39; where id = 1 2025-11-10T08:52:25.728929+08:00 0 [Note] [MY-012469] [InnoDB] *** (1) HOLDS THE LOCK(S): RECORD LOCKS space id 3 page no 4 n bits 72 index PRIMARY of table `Yang`.`t` trx id 3109 lock_mode X locks rec but not gap Record lock, heap no 5 PHYSICAL RECORD: n_fields 4; compact format; info bits 0 0: len 4; hex 00000002; asc ;; 1: len 6; hex 000000000c25; asc %;; 2: len 7; hex 0100000121024c; asc ! L;; 3: len 8; hex 4265636b506c7573; asc BeckPlus;; 2025-11-10T08:52:25.729280+08:00 0 [Note] [MY-012469] [InnoDB] *** (1) WAITING FOR THIS LOCK TO BE GRANTED: RECORD LOCKS space id 3 page no 4 n bits 72 index PRIMARY of table `Yang`.`t` trx id 3109 lock_mode X locks rec but not gap waiting Record lock, heap no 4 PHYSICAL RECORD: n_fields 4; compact format; info bits 0 0: len 4; hex 00000001; asc ;; 1: len 6; hex 000000000c24; asc $;; 2: len 7; hex 02000001230151; asc # Q;; 3: len 8; hex 59616e67506c7573; asc YangPlus;; 2025-11-10T08:52:25.729593+08:00 0 [Note] [MY-012469] [InnoDB] *** (2) TRANSACTION: TRANSACTION 3108, ACTIVE 30 sec starting index read mysql tables in use 1, locked 1 LOCK WAIT 3 lock struct(s), heap size 1128, 2 row lock(s), undo log entries 1 MySQL thread id 2276, OS thread handle 140566770149120, query id 16191 localhost hilife_db updating update t set name = \u0026#39;BeckPlus\u0026#39; where id = 2 2025-11-10T08:52:25.729658+08:00 0 [Note] [MY-012469] [InnoDB] *** (2) HOLDS THE LOCK(S): RECORD LOCKS space id 3 page no 4 n bits 72 index PRIMARY of table `Yang`.`t` trx id 3108 lock_mode X locks rec but not gap Record lock, heap no 4 PHYSICAL RECORD: n_fields 4; compact format; info bits 0 0: len 4; hex 00000001; asc ;; 1: len 6; hex 000000000c24; asc $;; 2: len 7; hex 02000001230151; asc # Q;; 3: len 8; hex 59616e67506c7573; asc YangPlus;; 2025-11-10T08:52:25.729972+08:00 0 [Note] [MY-012469] [InnoDB] *** (2) WAITING FOR THIS LOCK TO BE GRANTED: RECORD LOCKS space id 3 page no 4 n bits 72 index PRIMARY of table `Yang`.`t` trx id 3108 lock_mode X locks rec but not gap waiting Record lock, heap no 5 PHYSICAL RECORD: n_fields 4; compact format; info bits 0 0: len 4; hex 00000002; asc ;; 1: len 6; hex 000000000c25; asc %;; 2: len 7; hex 0100000121024c; asc ! L;; 3: len 8; hex 4265636b506c7573; asc BeckPlus;; 2025-11-10T08:52:25.730272+08:00 0 [Note] [MY-012469] [InnoDB] *** WE ROLL BACK TRANSACTION (2) Dead Lock ÁöÑË©±Ôºå\nJSON ÂèçËÄåÊ≤íÊúâË©≥Á¥∞ÁöÑË≥áË®äÔºå\nÂè™ËÉΩÂñÆÁ¥îÂÅöÂà∞Êúâ Dead Lock ÁôºÁîüÁöÑÈÄöÁü•Ôºå\n‰ΩÜ Table„ÄÅSyntax Á≠âÁ≠âË≥áË®äÈÇÑÊòØÈúÄË¶ÅÂõû Log Êü•ÁúãÔºå\nÂú®ÈÄôÈªû‰∏äÔºålog_sink_internal ÂÄíÊòØÊØî log_sink_json Â•ΩÂ§ö‰∫Ü\nERROR Log # Loki expr: count_over_time({type=\u0026ldquo;mysql/errorlog\u0026rdquo;} |= \u0026ldquo;ERROR\u0026rdquo; [1m])\nlog_sink_json Ê†ºÂºè\n{ \u0026#34;prio\u0026#34;: 1, \u0026#34;err_code\u0026#34;: 10045, \u0026#34;source_line\u0026#34;: 150, \u0026#34;source_file\u0026#34;: \u0026#34;event_scheduler.cc\u0026#34;, \u0026#34;function\u0026#34;: \u0026#34;print_warnings\u0026#34;, \u0026#34;msg\u0026#34;: \u0026#34;Event Scheduler: [xxxxx@localhost][DB.EVENT] Urgent ERROR\u0026#34;, \u0026#34;time\u0026#34;: \u0026#34;2025-11-10T15:50:00.903136+08:00\u0026#34;, \u0026#34;ts\u0026#34;: 1762761000903, \u0026#34;thread\u0026#34;: 781, \u0026#34;err_symbol\u0026#34;: \u0026#34;ER_EVENT_MESSAGE_STACK\u0026#34;, \u0026#34;SQL_state\u0026#34;: \u0026#34;HY000\u0026#34;, \u0026#34;subsystem\u0026#34;: \u0026#34;Server\u0026#34;, \u0026#34;label\u0026#34;: \u0026#34;Error\u0026#34; } { \u0026#34;prio\u0026#34;: 3, \u0026#34;err_code\u0026#34;: 10046, \u0026#34;source_line\u0026#34;: 429, \u0026#34;source_file\u0026#34;: \u0026#34;event_scheduler.cc\u0026#34;, \u0026#34;function\u0026#34;: \u0026#34;run\u0026#34;, \u0026#34;msg\u0026#34;: \u0026#34;Event Scheduler: [xxxxx@localhost].[DB.EVENT] event execution failed.\u0026#34;, \u0026#34;time\u0026#34;: \u0026#34;2025-11-10T15:50:00.903217+08:00\u0026#34;, \u0026#34;ts\u0026#34;: 1762761000903, \u0026#34;thread\u0026#34;: 781, \u0026#34;err_symbol\u0026#34;: \u0026#34;ER_EVENT_EXECUTION_FAILED\u0026#34;, \u0026#34;SQL_state\u0026#34;: \u0026#34;HY000\u0026#34;, \u0026#34;subsystem\u0026#34;: \u0026#34;Server\u0026#34;, \u0026#34;label\u0026#34;: \u0026#34;Note\u0026#34; } log_sink_internal Ê†ºÂºè\n2025-11-10T15:50:00.903136+08:00 781 [ERROR] [MY-010045] [Server] Event Scheduler: [xxxxx@localhost][DB.EVENT] Urgent ERROR 2025-11-10T15:50:00.903217+08:00 781 [Note] [MY-010046] [Server] Event Scheduler: [xxxxx@localhost].[DB.EVENT] event execution failed. Èô§‰∫Ü MySQL Eroor Log ÁúüÁöÑÂá∫ÁèæÁöÑÈåØË™§‰ª•Â§ñÔºå\nÈÄôÈÇÑÊúâÁî®‰æÜÊàëÂÄëÂÖßÈÉ®Êó•Â∏∏Á∂≠ÈÅã‰ΩøÁî®Ôºå\nÁÇ∫‰∫ÜÁ¢∫‰øùÁï∂ Event Scheduler Âá∫ÁèæÈåØË™§ÊôÇÂèØ‰ª•Âç≥ÊôÇÁôºÁèæÔºå\nÂú® Event ‰∏≠Êúâ‰ΩøÁî®\nSIGNAL SQLSTATE \u0026#39;45000\u0026#39; SET MESSAGE_TEXT = \u0026#39;Urgent ERROR\u0026#39;; ÈÄôÊñπÂºè‰æÜÂØ´ÂÖ• Error LogÔºå\nÂÜçÊê≠ÈÖç Loki ‰æÜÈÅîÂà∞Âç≥ÊôÇÂëäË≠¶\nReference # MySQL Documentation : 7.4.2 The Error Log Âæå‰æÜ MySQL 8.4 ÂÖßÈÉ®Ë®≠ÂÆöÊ™îÂÖ¨Áâà‰øÆÊîπÁÇ∫ log_error_services = \u0026#39;log_sink_internal; log_filter_dragnet; log_sink_json;\u0026#39; dragnet.log_error_filter_rules = \u0026#39;IF err_code == ER_ABORTING_USER_CONNECTION THEN drop.\u0026#39; ER_ABORTING_USER_CONNECTION ÊòØÂõ†ÁÇ∫ÊàëÂÄëÊû∂ÊßãÊòØÂª∫ÁΩÆÂú® GCE ‰∏äÔºå\nÂâçÈù¢ÊúÉÊéõ‰∏ÄÂ±§ Cloud Load Balancing ‰æÜÊèê‰æõÊúçÂãôÔºå\nËÄåÂÆÉÁöÑ Health checks ÊúÉÈÄ†Êàê MySQL Error Log ÁöÑÂ¢ûÈï∑Ôºå\nÈ°û‰ººÈÄôÊ®£\n2025-11-13T15:37:50.697889+08:00 59287548 [Note] [MY-010914] [Server] Got an error reading communication packets 2025-11-13T15:37:51.492153+08:00 59287550 [Note] [MY-010914] [Server] Got an error reading communication packets ÈÄôÊòØÂõ†ÁÇ∫ Health checks ÊòØ‰ΩøÁî® telnet Á≠âÁöÑÊñπÂºè‰æÜÂÅµÊ∏¨ TCP port ÊòØÂê¶ aliveÔºå\nÂú® MySQL ÊúÉË¢´Ë¶ñÁÇ∫ÈÄ£Á∑öÊ≤íÊúâÊ≠£Â∏∏Âª∫Á´ãÔºåÂ∞éËá¥ Error Log Âá∫ÁèæÈÄôË≥áË®äÔºå\nÂèàÂõ†ÁÇ∫ÊàëÂÄëÂÖßÈÉ®Ë®≠ÂÆöÊ™îÂÖ¨ÁâàÊúâË®≠ÂÆö log_error_verbosity ÁÇ∫ 3Ôºå\nÂ∞éËá¥ÊàëÂÄë Error Log ÊúÉÊúâÂ§ßÈáèÁöÑÁÑ°ÊïàË≥áË®äÁî¢Áîü„ÄÇ\nÊâÄ‰ª•ÊàëÂÄëÂú® filter ‰∏≠Êñ∞Â¢û\n'IF err_code == ER_ABORTING_USER_CONNECTION THEN drop.'\nÊó¢ÂèØ‰ª•‰øùÁïôÂéüÂßãÁöÑ Error Log (log_sink_internal)Ôºå\nÂèàÂèØ‰ª•Ê∏õÂ∞ëÈõúË®äÂæåÂÜçÂ≠òÂÖ• JSON Format ÁöÑ Error Log (log_sink_json)\n","date":"13 November 2025","permalink":"https://yangnianli.github.io/blog/error-log-enhanced/","section":"Blog","summary":"","title":"[MySQL 8.4] Error Log Enhanced"},{"content":"","date":null,"permalink":"https://yangnianli.github.io/categories/","section":"Categories","summary":"","title":"Categories"},{"content":"","date":null,"permalink":"https://yangnianli.github.io/categories/databases/","section":"Categories","summary":"","title":"Databases"},{"content":"","date":null,"permalink":"https://yangnianli.github.io/tags/mysql/","section":"Tags","summary":"","title":"Mysql"},{"content":"","date":null,"permalink":"https://yangnianli.github.io/tags/mysql8.4/","section":"Tags","summary":"","title":"Mysql8.4"},{"content":"","date":null,"permalink":"https://yangnianli.github.io/tags/","section":"Tags","summary":"","title":"Tags"},{"content":"","date":null,"permalink":"https://yangnianli.github.io/","section":"Yang's Blog","summary":"","title":"Yang's Blog"},{"content":" ÈÄôË∑ü‰πãÂâçÊí∞ÂØ´ÈÅéÁöÑÈÄôÁØáÈ°û‰ºº\n[AWS] Restoring a backup into an Amazon RDS for MySQL DB instance and Configuring external source replication\nÂè™ÊòØ‰∏ªËßíÂæû RDS for MySQL ËÆäÊàê‰∫Ü Aurora MySQL Introduction #ÈúÄÊ±ÇÊòØÂ∏åÊúõ GCP Âú® GCE ‰∏äËá™Âª∫ÁöÑ MySQL Ë∑ü AWS Aurora ‰∫íÁÇ∫ÂÇôÊè¥Ôºå\nÈÅîÂà∞ DR ÊïàÊûú„ÄÇ\nÂÖ∑È´îÊû∂ÊßãÂúñÂèØÂèÉËÄÉ ÈÅ©Áî®Â†¥ÊôØÂú®ÊñºÁï∂ DR ÁôºÁîüÊôÇÔºåÊúÉÂ∞á Source Âæû GCP ÂàáÈÅéÂéª AWS AuroraÔºå\nÁ≠âÂà∞ GCP outage Ëß£Ê±∫ÂæåÔºåÊúÉÂÜçÂÆâÊéíÊôÇÈñìÊää Source ÂàáÂõû‰æÜ GCP„ÄÇ\nÁÇ∫‰∫ÜÈÅîÂà∞ÈÄôÈúÄÊ±ÇÔºå\nÂéü‰æÜÁöÑ GCP ÈúÄË¶ÅÊúâ‰∏ÄÂè∞ ( Standby ) ÂÆöÊúüË∑ü AWS Aurora ÂêåÊ≠•Ë≥áÊñô - POC2 Êï¥Ê¢ùÈèàË∑ØÈ†êË®àÂÅöÊ≥ï\nAWS Aurora DR Step # GCP ÁöÑ MySQL ÊúçÂãô‰ΩøÁî® Percona XtraBackup ( PXB ) ÂÇô‰ªΩ ÂÇ≥ÈÄÅÂÇô‰ªΩÊ™îËá≥ AWS S3 ÈÇÑÂéüËá≥ AWS Aurora Âª∫ÁΩÆ Site-to-Site VPN ÊâìÈÄö AWS \u0026lt;-\u0026gt; GCP Âª∫ÁΩÆ MySQL Replication ( AWS -\u0026gt; GCP ) - POC1 Âª∫ÁΩÆ Aurora Reader Âª∫ÁΩÆ MySQL -\u0026gt; Aurora Reader ( GCP -\u0026gt; AWS ) - POC2 Âª∫ÁΩÆ AWS RDS DR #POC1 - Âª∫ÁΩÆ MySQL Replication ( AWS -\u0026gt; GCP ) #Ë´ãÂèÉÁÖß [AWS] Restoring a backup into an Amazon RDS for MySQL DB instance and Configuring external source replication Âª∫ÁΩÆÂç≥ÂèØÔºå\nÈúÄË¶ÅÁâπÂà•ÁïôÊÑè‰ª•‰∏ãÈÉ®ÂàÜ\ns3_source_engine : ÈÄôÈÇäË¶ÅËº∏ÂÖ• mysql s3_source_engine_version : ÈÄôÈÇäË¶ÅËº∏ÂÖ• MySQL ÁöÑÁâàÊú¨Ôºå‰ª•ÈÄôÊ¨°ÁÇ∫‰æãÔºåË¶ÅËº∏ÂÖ• 8.0 Ref : restore-db-cluster-from-s3 - AWS CLI\nË∑üÂêåÊ≠•ÁöÑË™ûÊ≥ï‰ΩøÁî® rds_set_external_source_with_auto_position\n### ÈÄ£Âà∞ RDSÔºåÂü∑Ë°å‰ª•‰∏ã Stored Procedures CALL mysql.rds_set_external_source_with_auto_position ( host_name , host_port , replication_user_name , replication_user_password , ssl_encryption ); ### Êú¨Ê¨°ÁØÑ‰æã‰ΩøÁî®ÁöÑÊåá‰ª§ CALL mysql.rds_set_external_source_with_auto_position ( \u0026#39;10.8.8.8\u0026#39; , 3306 , \u0026#39;aws_rds_rep\u0026#39; , \u0026#39;YangTest@123\u0026#39; , 0 ); ### ÈñãÂßãÂêåÊ≠• CALL mysql.rds_start_replication() ; ### ÁÑ∂ÂæåÂ∞±ÊàêÂäü‰∫Ü SHOW REPLICA STATUS \\G Replica_IO_Running: Yes Replica_SQL_Running: Yes ÂÖ∂È§ò Aurora Â∞±Ë∑üÂª∫ÁΩÆ RDS ÊñπÂºèÂ§ßÂêåÂ∞èÁï∞\nÂÖ¨Âè∏ÂÖßÈÉ®‰ΩøÁî®ÁöÑ Terraform Aurora Modules ÊúâÊîØÊè¥ Restore From S3 ÁöÑÁõ∏ÈóúÈÖçÁΩÆÔºå ‰ΩÜÊòØÂÖ¨Âè∏ÂÖßÈÉ® ModulesÔºåÁÑ°Ê≥ïÂàÜ‰∫´Ë´ãË¶ãË´íÔºåÊúâÂïèÈ°åÂèØ‰ª•Ë©¢ÂïèÂì¶\nPOC2 - Âª∫ÁΩÆ MySQL -\u0026gt; Aurora Reader ( GCP -\u0026gt; AWS ) #ÂÜçÂª∫ÁΩÆ‰∏ÄÂè∞ Aurora Reader # ÈÄôÈÇä‰ª• 02 ÁÇ∫‰æãÔºå\nÂú® Aurora Cluster ‰∏≠ÔºåÁ¨¨‰∏ÄÂè∞Âª∫ÁΩÆÁöÑ Instance Â∞±ÊòØ WriterÔºåÂÖ∂È§òÈÉΩÊòØ ReaderÔºå\nÊâÄ‰ª•ÁõÆÂâçË¶èÂäÉ‰∏äÊúÉÂ∏åÊúõ‰ΩøÁî®ÁÑ°ÊÑèÁæ©ÁöÑÊµÅÊ∞¥Ëôü‰æÜ‰ª£ÊõøÊ©üÂô®ÂêçÁ®±Ôºå\nËÄå‰∏çÊòØÊúâÊÑèÁæ©ÁöÑ Writer ÊàñËÄÖÊòØ Reader\nË®≠ÂÆö /etc/hosts ( ÈÅéÊ∏°Êúü‰ΩøÁî®ÔºåÂæåÁ∫åÂ∞éÂÖ• Internal DNS Ê©üÂà∂ÂæåÂèØ‰ª•ÂøΩÁï•Ê≠§Ê≠•È©ü ) #ÂÖà‰ΩøÁî® AWS bastion ËóâÁî± nslookup ÂèñÂæó Aurora ÁöÑÂØ¶Èöõ IPÔºå\n‰ª•‰∏ãÂúñÁÇ∫‰æãÔºåIP ÁÇ∫ 10.2.1.33\nÂ∞á Aurora Áõ∏ÈóúË≥áË®äË®≠ÂÆöÊñº GCP GCE ÁöÑ /etc/hosts\nAurora ÈñãÂïü Binary Logs ‰øùÁïô ( Âæû Writer Ë®≠ÂÆö ) # Ref : Setting up binary log replication for Aurora MySQL - Amazon Aurora\nÂª∫Á´ã GCP -\u0026gt; AWS ÂêåÊ≠• # ÁÑ∂ÂæåÂ∞±Â§±ÊïóÂï¶ # MySQL localhost SQL \u0026gt; SHOW REPLICA STATUS \\G *************************** 1. row *************************** Replica_IO_State: Source_Host: xxxxxxx-xxxx-xxx-xxxxx-xxxxxx-xx.xxxxxxxxxxxx.xxxxxxxxx.rds.amazonaws.com Source_User: ******* Source_Port: 3306 Connect_Retry: 60 Source_Log_File: Read_Source_Log_Pos: 4 Relay_Log_File: dba-xxxxx-xxxxxx-xxxxxxx-xxxx-relay-bin.000001 Relay_Log_Pos: 4 Relay_Source_Log_File: Replica_IO_Running: No Replica_SQL_Running: Yes Replicate_Do_DB: Replicate_Ignore_DB: Replicate_Do_Table: Replicate_Ignore_Table: Replicate_Wild_Do_Table: Replicate_Wild_Ignore_Table: Last_Errno: 0 Last_Error: Skip_Counter: 0 Exec_Source_Log_Pos: 0 Relay_Log_Space: 157 Until_Condition: None Until_Log_File: Until_Log_Pos: 0 Source_SSL_Allowed: No Source_SSL_CA_File: Source_SSL_CA_Path: Source_SSL_Cert: Source_SSL_Cipher: Source_SSL_Key: Seconds_Behind_Source: 0 Source_SSL_Verify_Server_Cert: No Last_IO_Errno: 13114 Last_IO_Error: Got fatal error 1236 from source when reading data from binary log: \u0026#39;Binary log is not open\u0026#39; Last_SQL_Errno: 0 Last_SQL_Error: Replicate_Ignore_Server_Ids: Source_Server_Id: 0 Source_UUID: 7868ba12-6342-3cbb-9b8f-ca35a09bf469 Source_Info_File: mysql.slave_master_info SQL_Delay: 0 SQL_Remaining_Delay: NULL Replica_SQL_Running_State: Replica has read all relay log; waiting for more updates Source_Retry_Count: 86400 Source_Bind: Last_IO_Error_Timestamp: 251008 12:41:17 Last_SQL_Error_Timestamp: Source_SSL_Crl: Source_SSL_Crlpath: Retrieved_Gtid_Set: Executed_Gtid_Set: 1b31a695-a3f4-11f0-a8a0-42010a246409:1-45 Auto_Position: 1 Replicate_Rewrite_DB: Channel_Name: Source_TLS_Version: Source_public_key_path: Get_Source_public_key: 0 Network_Namespace: 1 row in set (0.0006 sec) ÈåØË™§Ë®äÊÅØÊòØÊâæ‰∏çÂà∞ Binary LogsÔºå\nÂæû Reader ÁöÑ SHOW VARIABLES Êü•ÁúãÁ¢∫ÂØ¶Ê≤íÊúâÈñãÂïüÔºå\nÊü•‰∫ÜÂπæÁØáÊñáÁ´†Ë∑üÂÆòÊñπÊñá‰ª∂ÔºåÁõÆÂâçÊòØÊá∑Áñë Replica ‰∏çÊîØÊè¥ÈñãÂïü binary logsÔºå\nÂæåÁ∫åÊúÉÂÜçËàá AWS TAM Á¢∫Ë™ç\nRef :\nNote: Amazon Aurora MySQL does not support BinLog replication on read replicas.\nAmazon Aurora MySQL - Hevo Data You can only pull binary logs from the Writer Instance.\nCan we configure separate binary logging (binlog) on Aurora MySQL\u0026rsquo;s Read REplica instance? POC3 - Âª∫ÁΩÆ MySQL -\u0026gt; Aurora Writer ( GCP -\u0026gt; AWS ) # ‰∏äÈù¢ÁöÑÊ≠•È©üÂÜç‰æÜ‰∏ÄÊ¨°ÔºåÂè™ÊòØÈÄôÊ¨°ÊîπÊàê Writer\nË®≠ÂÆö /etc/hosts ( ÈÅéÊ∏°Êúü‰ΩøÁî®ÔºåÂæåÁ∫åÂ∞éÂÖ• Internal DNS Ê©üÂà∂ÂæåÂèØ‰ª•ÂøΩÁï•Ê≠§Ê≠•È©ü ) #ÂÖà‰ΩøÁî® AWS bastion ËóâÁî± nslookup ÂèñÂæó Aurora ÁöÑÂØ¶Èöõ IPÔºå\n‰ª•‰∏ãÂúñÁÇ∫‰æãÔºåIP ÁÇ∫ 10.2.1.100\nÂ∞á Aurora Áõ∏ÈóúË≥áË®äË®≠ÂÆöÊñº GCP GCE ÁöÑ /etc/hosts\nÂª∫Á´ã GCP -\u0026gt; AWS ÂêåÊ≠• # ÈÄôÊ¨°Â∞±ÊàêÂäüÂõâ #### ÈñãÂßãÂêåÊ≠• START REPLICA ; ### ÁÑ∂ÂæåÂ∞±ÊàêÂäü‰∫Ü SHOW REPLICA STATUS \\G Replica_IO_Running: Yes Replica_SQL_Running: Yes Summary #Ê≤í‰ªÄÈ∫ºÁâπÂà•ÁöÑÔºåÂü∫Êú¨‰∏äÈÄôË∑ü Aurora Ê≤íÊúâÂ§™Â§öÁõ∏ÈóúÔºå\nÈô§‰∫Ü Binary Logs ÁöÑÈÉ®ÂàÜÊúâÈªûÂ∑ÆÁï∞‰ª•Â§ñÔºå\nÂÖ∂È§òÁöÑÂè™Ë¶ÅÈÅãÁî® MySQL ÁöÑÁü•Ë≠òÔºå‰∏çÊúÉÈÅáÂà∞‰ªÄÈ∫ºÂ§™Â§ßÁöÑÂïèÈ°å\nAfterword #ERROR: 1267 (HY000): Illegal mix of collations (utf8mb4_general_ci,IMPLICIT) and (utf8mb4_0900_ai_ci,IMPLICIT) for operation \u0026lsquo;regexp_like\u0026rsquo; #‰∏ÄÈñãÂßãÊúâÈÅáÂà∞Ë™ûÁ≥ªÁöÑÂïèÈ°åÔºå\nÂú® GCP ( Source ) ‰ΩøÁî®ÊàëÂÄë 8.0 ÂÖ¨ÁâàË®≠ÂÆöÊ™îÔºå\nÁï∂ÂàùÁÇ∫‰∫ÜÂÖºÂÆπ 5.7ÔºåÊâÄ‰ª•ÊúâÈ°çÂ§ñË®≠ÂÆö\ncollation_server = utf8mb4_general_ci\nÂæåÁ∫å‰ΩøÁî® PXB ÈÇÑÂéüËá≥ Aurora ÂæåÔºå\nÂá∫Áèæ PROCEDURE ( mysql.rds_set_external_source_with_auto_position ) ÁÑ°Ê≥ï‰ΩøÁî®ÁöÑÂïèÈ°å\nÊü•‰∫Ü‰∏Ä‰∏ãÔºåË∑üË™ûÁ≥ªÊúâÈóúÔºå\nÁï∂ Source Ë®≠ÂÆö collation_server = utf8mb4_general_ciÔºå\nÁÑ∂Âæå‰ΩøÁî® PXB ÈÇÑÂéüËá≥ Aurora ÂæåÔºå\nAuroa PROCEDURE ÁöÑË®≠ÂÆö\ncollation_connection: utf8mb4_0900_ai_ci Database Collation: utf8mb4_general_ci È†êË®≠ Aurora Ê≤í‰øÆÊîπË™ûÁ≥ªÂª∫Á´ãÂæåÁöÑ PROCEDURE Ë®≠ÂÆö\ncollation_connection: utf8mb4_0900_ai_ci Database Collation: utf8mb4_0900_ai_ci PROCEDURE ‰∏≠Êúâ‰∏ÄÊÆµ‰ΩøÁî®Âà∞ REGEXP\nMySQL \u0026gt; SHOW CREATE PROCEDURE mysql.rds_set_external_source_with_auto_position \\G ... SET @regex = \u0026#39;.*\\\u0026#34;[[:space:]]*,[[:space:]]*[a-zA-Z_]+[[:space:]]*=[[:space:]]*\\\u0026#34;.*\u0026#39;; IF host REGEXP @regex OR user REGEXP @regex OR passwd REGEXP @regex THEN SELECT \u0026#34;Invalid arguments\u0026#34; AS Message; ... Êé®Ê∏¨ËàáÈÄôÊúâÈóúÔºå\nÂõ†Ë™ûÁ≥ªÂ∑ÆÁï∞ÔºåÈÄ†Êàê‰∏äËø∞ÈåØË™§ÔºåÊö´ÊôÇÊ≤íÊÉ≥Âà∞Ëß£Ê≥ïÔºå\nÂæåÁ∫åÊúÉÂÜçËàá AWS TAM Á¢∫Ë™ç\nÁõÆÂâç workaround ÊòØÊää Source ÁöÑ collation_server Ë®≠ÂÆöÁßªÈô§Ôºå\nÁ∂≠ÊåÅÈ†êË®≠ÁöÑ utf8mb4_0900_ai_ci\nReference # Aurora User Guide ","date":"13 October 2025","permalink":"https://yangnianli.github.io/blog/cross_cloud-mysql-and-aurora-dr-architecture-proof-of-concept/","section":"Blog","summary":"","title":"[AWS] Cross-Cloud MySQL and Aurora DR Architecture - Proof of Concept"},{"content":"","date":null,"permalink":"https://yangnianli.github.io/tags/aurora/","section":"Tags","summary":"","title":"Aurora"},{"content":"","date":null,"permalink":"https://yangnianli.github.io/categories/aws/","section":"Categories","summary":"","title":"Aws"},{"content":" ÈÄôÊòØ What Is New in MySQL 8.4 since MySQL 8.0 ÁöÑÁ≥ªÂàóÊñáÔºå\nÊúÉÈáùÂ∞çÈÉ®ÂàÜÊàëË¶∫ÂæóË∑üÊó•Â∏∏Á∂≠ÈÅãÊúâÈóúÁöÑÊõ¥ÂãïÁâπÂà•Á†îÁ©∂Ôºå\nÂÖ∂È§òÁöÑÂ∞±Áï∂ÊïÖ‰∫ãÊõ∏ÔºåÁúãÈÅéÁü•ÈÅìÂç≥ÂèØ Introduction #Scalar correlated subqueries to derived tables.\nMySQL 8.4.0 lifts a previous restriction on transforming a correlated scalar subquery to a derived table such that an operand of the equality expression which did not contain an outer reference could be a simple column reference only.\nThis means that inner columns can be contained in deterministic expressions, as shown here:\nfunc1(.., funcN(.., inner-column-a, ..), inner-column-b) = outside-expression inner-column-a + inner-column-b = outside-expression For example, the following query is now supported for optimization:\nSELECT * FROM t1 WHERE ( SELECT func(t2.a) FROM t2 WHERE func(t2.a) = t1.a ) \u0026gt; 0; The inner operand cannot contain outer column references; likewise, the outer operand cannot contain inner column references. In addition, the inner operand cannot contain a subquery.\nIf the transformed subquery has explicit grouping, functional dependency analysis may be excessively pessimistic, resulting in an error such as ERROR 1055 (42000): Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column ....\nFor the InnoDB storage engine, the transform is disabled by default (that is, the subquery_to_derived flag of the optimizer_switch variable is not enabled); in this case, such queries pass without raising any errors, but are also not transformed.\nSee Section 15.2.15.7, ‚ÄúCorrelated Subqueries‚Äù, for more information.\n‰ª•‰∏äÂºïÁî®Ëá≥ÂÆòÊñπÂéüÊñá\nSummary #ÂÖàË¨õÁµêË´ñÔºåÈ†êË®≠ subquery_to_derived ÈÄô optimizer_switch ÊòØ ÈóúÈñâ ÁöÑÔºå\nÊàëÂÄë‰πüÊ≤íÊúâÁâπÂà•Ë™øÊï¥ÈÅéË®≠ÂÆöÊ™îÂÖ¨ÁâàÔºåÊâÄ‰ª•ÂΩ±ÈüøÊ≤íÊúâÂæàÂ§ßÔºå\nÁü•ÈÅìÊúâÈÄôÂäüËÉΩÔºåÊó•ÂæåÊúâÈúÄË¶ÅÊôÇÔºåÂÜçÁúãÁúãÊúâÊ≤íÊúâÂêàÈÅ©Âç≥ÂèØ„ÄÇ\nÈ†êË®≠ÊòØÈóúÈñâÁöÑÂéüÂõ†ÊòØÔºå\nÂú®Â§ßÂ§öÊÉÖÊ≥Å‰∏ãÔºåÈñãÂïüË©≤ÂèÉÊï∏‰∏¶Ê≤íÊúâÈ°ØËëóÁöÑÊïàËÉΩÊîπÂñÑ ( ÁîöËá≥ÊúÉÊúâÊõ¥ÊÖ¢ÁöÑÁèæË±° )\nÈÄôÂè•Ë©±ÊòØÂÆòÊñπÊñáÊ™îÂØ´ÁöÑÔºå‰∏çÊòØÈÄ†Ë¨† ü§ó\nÂéüÊñá : The default value for this flag is off, since, in most cases, enabling this optimization does not produce any noticeable improvement in performance (and in many cases can even make queries run more slowly)\nÈÄôÂäüËÉΩÊúÄÊó©ÊòØÂú® 8.0.21 Êñ∞Â¢ûÁöÑÔºå8.4 Âè™ÊòØÂ∞çË©≤ÂäüËÉΩÂ¢ûÂä†Êõ¥Â§öÊîØÊè¥Ôºå\nÁï∂ correlated subqueries ÊòØ deterministic funtions ÊôÇÔºå\nÂ∞±ÂèØ‰ª•Ë¢´ subquery_to_derived ÈÄ≤Ë°åÊîπÂØ´ÂÑ™Âåñ\nË´ãÂèÉËÄÉ‰ª•‰∏ãÂ∑ÆÁï∞\nMySQL 8.4 #SHOW CREATE TABLE t1 \\G *************************** 1. row *************************** Table: t1 Create Table: CREATE TABLE `t1` ( `a` int NOT NULL, PRIMARY KEY (`a`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utfTE TABLE t2 \\G *************************** 1. row *************************** Table: t2 Create Table: CREATE TABLE `t2` ( `a` int NOT NULL, PRIMARY KEY (`a`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci /* subquery_to_derived È†êË®≠ÁÇ∫ OFF */ SELECT @@optimizer_switch like \u0026#39;%subquery_to_derived=OFF%\u0026#39; AS \u0026#39;subquery_to_derived=OFF\u0026#39; ; +-------------------------+ | subquery_to_derived=OFF | +-------------------------+ | 1 | +-------------------------+ 1 row in set (0.0008 sec) EXPLAIN SELECT * FROM t1 WHERE ( SELECT COUNT(t2.a) FROM t2 WHERE CAST(t2.a AS BINARY) = t1.a ) \u0026gt; 0 ; +----+--------------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+--------------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+ | 1 | PRIMARY | t1 | NULL | index | NULL | PRIMARY | 4 | NULL | 1 | 100 | Using where; Using index | | 2 | DEPENDENT SUBQUERY | t2 | NULL | index | NULL | PRIMARY | 4 | NULL | 1 | 100 | Using where; Using index | +----+--------------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+ 2 rows in set, 2 warnings (0.0008 sec) SET SESSION optimizer_switch = \u0026#39;subquery_to_derived=on\u0026#39; ; /* subquery_to_derived ÊîπÊàê ON */ SELECT @@optimizer_switch like \u0026#39;%subquery_to_derived=ON%\u0026#39; AS \u0026#39;subquery_to_derived=ON\u0026#39; ; +------------------------+ | subquery_to_derived=ON | +------------------------+ | 1 | +------------------------+ 1 row in set (0.0003 sec) EXPLAIN SELECT * FROM t1 WHERE ( SELECT COUNT(t2.a) FROM t2 WHERE CAST(t2.a AS BINARY) = t1.a ) \u0026gt; 0 ; +----+-------------+------------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------------------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+-------------+------------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------------------------+ | 1 | PRIMARY | t1 | NULL | index | NULL | PRIMARY | 4 | NULL | 1 | 100 | Using index | | 1 | PRIMARY | \u0026lt;derived2\u0026gt; | NULL | ALL | NULL | NULL | NULL | NULL | 2 | 100 | Using where; Using join buffer (hash join) | | 2 | DERIVED | t2 | NULL | index | PRIMARY | PRIMARY | 4 | NULL | 1 | 100 | Using index; Using temporary | +----+-------------+------------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------------------------+ 3 rows in set, 2 warnings (0.0014 sec) MySQL 8.0 #SHOW CREATE TABLE t1 \\G *************************** 1. row *************************** Table: t1 Create Table: CREATE TABLE `t1` ( `a` int NOT NULL, PRIMARY KEY (`a`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utfTE TABLE t2 \\G *************************** 1. row *************************** Table: t2 Create Table: CREATE TABLE `t2` ( `a` int NOT NULL, PRIMARY KEY (`a`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci /* subquery_to_derived È†êË®≠ÁÇ∫ OFF */ SELECT @@optimizer_switch like \u0026#39;%subquery_to_derived=OFF%\u0026#39; AS \u0026#39;subquery_to_derived=OFF\u0026#39; ; +-------------------------+ | subquery_to_derived=OFF | +-------------------------+ | 1 | +-------------------------+ 1 row in set (0.0007 sec) EXPLAIN SELECT * FROM t1 WHERE ( SELECT COUNT(t2.a) FROM t2 WHERE CAST(t2.a AS BINARY) = t1.a ) \u0026gt; 0 ; +----+--------------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+--------------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+ | 1 | PRIMARY | t1 | NULL | index | NULL | PRIMARY | 4 | NULL | 1 | 100 | Using where; Using index | | 2 | DEPENDENT SUBQUERY | t2 | NULL | index | NULL | PRIMARY | 4 | NULL | 1 | 100 | Using where; Using index | +----+--------------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+ 2 rows in set, 2 warnings (0.0016 sec) SET SESSION optimizer_switch = \u0026#39;subquery_to_derived=on\u0026#39; ; /* subquery_to_derived ÊîπÊàê ON */ SELECT @@optimizer_switch like \u0026#39;%subquery_to_derived=ON%\u0026#39; AS \u0026#39;subquery_to_derived=ON\u0026#39; ; +------------------------+ | subquery_to_derived=ON | +------------------------+ | 1 | +------------------------+ 1 row in set (0.0008 sec) EXPLAIN SELECT * FROM t1 WHERE ( SELECT COUNT(t2.a) FROM t2 WHERE CAST(t2.a AS BINARY) = t1.a ) \u0026gt; 0 ; +----+--------------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+ | id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra | +----+--------------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+ | 1 | PRIMARY | t1 | NULL | index | NULL | PRIMARY | 4 | NULL | 1 | 100 | Using where; Using index | | 2 | DEPENDENT SUBQUERY | t2 | NULL | index | NULL | PRIMARY | 4 | NULL | 1 | 100 | Using where; Using index | +----+--------------------+-------+------------+-------+---------------+---------+---------+------+------+----------+--------------------------+ 2 rows in set, 2 warnings (0.0010 sec) ‰∏ªË¶ÅÈóúÊ≥®ÊñºÊúÄÂæå EXPLAIN ÁöÑÁµêÊûú\nÂú® MySQL 8.4ÔºåÈñãÂïü subquery_to_derived=ON ÊôÇÔºå\nÂè™Ë¶Å correlated subqueries ÁöÑ functions ÊòØ deterministicÔºå\nÂ∞±ÂèØ‰ª•Ë¢´ÊîπÂØ´Êàê derived table ÁöÑË™ûÊ≥ïÈÄ≤Ë°åÊü•Ë©¢„ÄÇ\nÂú® MySQL 8.0 ÊôÇÔºåÂè™ÊúâÊîØÊè¥ simple column references\nType Example Deterministic Functions SUBSTR(),CONCAT(),CAST()... Nondeterministic Functions RAND(),NOW(),UUID()... Afterword #ÈÄôÁØáÂÜçÁ†îÁ©∂ÂæåÂ∞±ÈªòÈªòÂú∞ÊääÂÆÉÁßªÈô§ ‚≠ê ÁöÑÊ®ôË®ò‰∫Ü üòÇ\n‰∏ÄÈñãÂßãÊòØÂõ†ÁÇ∫ÁúãÂà∞ÈÄôË∑ü optimizer_switch ÊúâÈóúÔºå\nÊâÄ‰ª•ÊâçÂ∞áÂÖ∂Ê®ôË®òÁÇ∫ ‚≠êÔºå\nÊ∑±ÂÖ•Á†îÁ©∂ÂæåÁôºÁèæÈÄôÁï∞Âãï‰ºº‰πéÊ≤í‰ªÄÈ∫ºÂ§™Â§ßÁöÑÂΩ±ÈüøÔºå\nÁï¢Á´üÂÆòÊñπÊñáÊ™îÈÉΩË™™‰∫ÜÔºåÈ†êË®≠ÁÇ∫ ÈóúÈñâ ÁöÑÂéüÂõ†ÊòØÂõ†ÁÇ∫Â∞çÊñºÂ§ßÂ§öÊï∏ÊáâÁî®‰æÜË™™Ôºå\nÈÄôÊîπËÆä‰∏¶Ê≤íÊúâÂ∏∂‰æÜÈ°ØËëóÁöÑÊîπÂñÑ„ÄÇ\nÈÄôÊôÇÂèçËÄåËÆìÊàëÂ•ΩÂ•áÁÇ∫‰ªÄÈ∫ºÊúâÈÄôÊîπÂãïÔºå‰∫ãÊÉÖÁöÑÊ∫êÈ†≠ÊòØ‰ªÄÈ∫º ? Êé•ËëóÂ∞±ÂéªÁøª‰∫Ü WorkLogÔºå\nOpen Source ÁöÑÂ•ΩËôïÂ∞±ÊòØÂÖ®ÈÉ®ÁöÑÁï∞ÂãïÁ¥ÄÈåÑÈÉΩÂèØ‰ª•Âú® Git ‰∏äÊâæÂà∞Ôºå\nËÄå‰∏îÈÄôÁ®ÆÊúâË¶èÊ®°ÁöÑ Open Source Project ÈÉΩÊúÉÊúâË©≥Á¥∞ÁöÑË™™Êòé‰ª•ÂèäÁ¥ÄÈåÑ„ÄÇ\nMySQL 8.0 ‰∏ÄÈñãÂßãÊñ∞Â¢ûÁöÑ commit Âú® WL#13520Ôºå\nÈáçÈªûÂú®ÊñºÂÖ∂‰∏≠ÂØ´Âà∞ÁöÑÈÄôÂè• : It is on by default for secondary engines like RAPID.\nÂèàÂ∏∂‰æÜ‰∫ÜÂè¶Â§ñÁöÑÂ•ΩÂ•áÔºå\n‰ªÄÈ∫ºÊòØ Secondary Engines ?\nMySQL ‰∏çÊòØÂ∞±Âè™Ââ©‰∏ã InnoDB Engines ËÄåÂ∑≤Âóé ? ( NDB Èô§Â§ñ )\nÊü•‰∫Ü‰∏Ä‰∏ãÁôºÁèæÔºå\nÂéü‰æÜÈÄôÂÖ®ÊòØÁÇ∫‰∫Ü Oracle MySQL Enterprise Âú®Èã™Ë∑ØÂëÄ üòà\n‰∏çÁÆ°ÊòØ Secondary Engines ÈÇÑÊòØ RAPIDÔºå\nÈÄôÈÉΩË∑ü MySQL HeatWave ÊúâÈóúÔºå\nMySQL 8.4 ÈÄôÊ¨°ÁöÑÁï∞Âãï commit Âú® WL#15540Ôºå\nÂÖ∂‰∏≠ÁöÑÈÄôÂè• : This transformation is needed by Heatwave/RAPID, which doesn't support subqueries in the WHERE clause. ‰πüÂèØ‰ª•ÁôºÁèæÔºå\nÈÄôÁï∞ÂãïÈÉΩÊòØÁÇ∫‰∫Ü MySQL HeatWave ÂÅöÁöÑÊîπÂñÑÔºå\nÈÄô‰∏ãÁñëÊÉëÈÉΩËß£Èñã‰∫ÜÔºå\nÁõÆÂâçÂÖ¨Âè∏‰∏ªË¶ÅÊòØ‰ΩøÁî® Percona MySQLÔºå\nÁü≠ÊôÇÈñìÂÖßÊáâË©≤ÊòØÊ≤íËæ¶Ê≥ïÊë∏Âà∞ MySQL HeatWave ‰æÜÁé©Áé©‰∫ÜÔºå\nÂè™ËÉΩÁ≠âÂà∞Êó•ÂæåÊúâÊúù‰∏ÄÊó•ÔºåÂÜç‰æÜÁúãÁúãÈÄôÊîπÂãïÂ∞çÊñº MySQL HeatWave Êúâ‰ªÄÈ∫ºÊîπÂñÑÂêß\nReference # GitHub : mysql-server Commit 8fda114 GitHub : mysql-server Commit 0354e46 MySQL Documentation : 15.2.15.7 Corrlated Subqueries MySQL HeatWave Documentation : 4.2.6.2 Define the Secondary Engine ","date":"1 October 2025","permalink":"https://yangnianli.github.io/blog/scalar-correlated-subqueries-to-derived-tables/","section":"Blog","summary":"","title":"[MySQL 8.4] Scalar Correlated Subqueries to Derived Tables"},{"content":"Introduction #ÈúÄÊ±ÇÊòØÂ∏åÊúõ GCP ‰∏ä‰ΩøÁî® GCE Ëá™Êû∂ÁöÑ MySQL ÊúçÂãôÂèØ‰ª•ÂêåÊ≠•Ë≥áÊñôËá≥ AWS RDSÔºå\nÊèê‰æõÁµ¶ÈÉ®ÁΩ≤Êñº AWS ÁöÑÊúçÂãôÂ≠òÂèñ‰ΩøÁî®ÔºåÂÉÖÈúÄË¶Å ReadOnlyÔºå‰∏çÈúÄË¶Å WriteÔºå\nÈô§‰∫ÜÂèØ‰ª•Èôç‰Ωé AWS ÁöÑÁ®ãÂºè ‚Üí GCP ÁöÑÁ∂≤Ë∑ØÂÇ≥Ëº∏Ë≤ªÁî®‰ª•ÂèäÂª∂ÈÅ≤Ôºå\n‰πüÂèØ‰ª•ÈÅîÂà∞ DR ÁöÑ‰ΩúÁî®\nÈ†êË®àÂÅöÊ≥ï\nGCP ÁöÑ MySQL ÊúçÂãô‰ΩøÁî® Percona XtraBackup ( PXB ) ÂÇô‰ªΩ\nÂÇ≥ÈÄÅÂÇô‰ªΩÊ™îËá≥ AWS S3\nÈÇÑÂéüËá≥ AWS RDS\nÂª∫ÁΩÆÂ§ñÁ∂≤ ( or Site-to-Site VPN ) ÂêåÊ≠• ( AWS ‚Üí GCP )\nÂü∫Êú¨‰∏äÔºåÈÄô‰∫õÂäüËÉΩ RDS ÈÉΩÊúâÊèê‰æõÔºå‰πüÊúâÁõ∏Â∞çÊáâÁöÑÂÆòÊñπÊñá‰ª∂Ôºå\nÊÉ≥‰∫Ü‰∏Ä‰∏ãÔºåÈõ£Â∫¶‰∏çÂ§ßÔºåÂ∞±Áõ¥Êé•ÂãïÂ∑•Âêß\np.s. Èô§‰∫Ü‰ΩøÁî® MySQL Native Replication ‰ª•Â§ñÔºå\nÈÇÑÊúâÂè¶Â§ñ‰∏ÄÂÄãÂÇôÊ°à - AWS DMS\n‰πüÂèØ‰ª•ÈÅîÂà∞Áõ∏ÂêåÁöÑÁµêÊûúÔºåÂè™ÊòØÂêåÊ≠•Ë≥áÊñôÁöÑÊñπÂºèÊîπÊàê‰ΩøÁî® DMS ÂØ¶Áèæ\nRestoring a backup into an Amazon RDS for MySQL DB instance # Âª∫ÁΩÆ GCP Ê∏¨Ë©¶Ê©ü # Âõ†ÁÇ∫Ê∏¨Ë©¶ÈÅéÁ®ãÊúÉÈúÄË¶ÅÊñ∞Â¢û fw Áõ∏ÈóúË®≠ÂÆöÔºåÊïÖÊ≠§Ê¨°Ê∏¨Ë©¶ÊòØ‰ΩøÁî®Ê∏¨Ë©¶Â∞àÊ°àËá™Âª∫ VPCÔºå\nÊ≠£ÂºèÂïüÁî®ÊôÇÊòØ‰ΩøÁî® XPN Êû∂ÊßãÔºå‰ΩÜÂéüÁêÜË∑üÊ≠•È©üÊòØÁõ∏ÂêåÁöÑ\nÂª∫ÁΩÆ VPC / Subnets #### VPC gcloud compute networks create ${VPC_NAME} \\ --project=${PROJECT_ID} \\ --subnet-mode=custom \\ --mtu=1460 \\ --bgp-routing-mode=regional \\ --bgp-best-path-selection-mode=legacy ### Subnets ( CIDR Ëá™ÂÆöÂç≥ÂèØ ) gcloud compute networks subnets create ${SUBNETS_NAME} \\ --project=${PROJECT_ID} \\ --range=${CIDR} \\ --stack-type=IPV4_ONLY \\ --network=${VPC_NAME} \\ --region=asia-east1 Âª∫ÁΩÆ FW #### Allow AWS RDS ( source-ranges Âæû AWS VPC -\u0026gt; NAT gateways Êü•Áúã ) gcloud compute firewall-rules create ${FW_NAME} \\ --project=${PROJECT_ID} \\ --direction=INGRESS \\ --priority=1000 \\ --network=${VPC_NAME} \\ --action=ALLOW \\ --rules=tcp:3306 \\ --source-ranges=18.138.94.177/32,52.77.51.245/32,18.138.128.251/32 Âª∫ÁΩÆ MySQL #ÈÄôÈÇäÊòØ‰ΩøÁî®ÂÖßÈÉ®Ëá™Á†îÁöÑÂπ≥Âè∞Âª∫ÁΩÆÔºåÂ∞±‰∏çÂ±ïÈñãË™™Êòé‰∫Ü\nÂª∫ÁΩÆ External Load Balancer #Êñ∞Â¢û External Load Balancer Ë∑ü Instance GroupsÔºåÊ≤íÊúâ‰ªÄÈ∫ºÈúÄË¶ÅÁâπÂà•ÁïôÊÑèÁöÑ\n‰ΩøÁî® PXB ÂÇô‰ªΩËá≥ AWS S3 #Install AWS CLI #curl \u0026#34;https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\u0026#34; -o \u0026#34;awscliv2.zip\u0026#34; unzip awscliv2.zip sudo ./aws/install Configuration AWS CLI # Âõ†ÁÇ∫ AWS Ê∏¨Ë©¶Áí∞Â¢ÉÁöÑ Account ÊòØÊé°Áî® SSO ÁôªÂÖ•Ôºå\n‰πãÂâç‰ΩøÁî®ÈÅéÁöÑ Access Key ÊñπÊ°àÂ∑≤Á∂ìÁÑ°Ê≥ï‰ΩøÁî®Âõâ\naws configure sso --use-device-code PXB ÂÇô‰ªΩËá≥ AWS S3 #### Â∞±ÂñÆÁ¥îÂÇô‰ªΩÔºåÊ≤íÁâπÂà•Ë¶ÅË™™ÊòéÁöÑÔºåË®òÂæó‰ΩøÁî® xbstream xtrabackup --backup --user=${USERNAME} \\ --password \\ --stream=xbstream \u0026gt; yangtest.xbstream ### ÂÇ≥Âà∞ s3 aws s3 cp yangtest.xbstream s3://aws_s3_bucket_name ÈÇÑÂéüËá≥ AWS RDS # ÂÖ¨Âè∏ÂÖßÈÉ®‰ΩøÁî®ÁöÑ Terraform RDS Modules ÊúâÊîØÊè¥ Restore From S3 ÁöÑÁõ∏ÈóúÈÖçÁΩÆÔºå\n‰ΩÜÊòØÂÖ¨Âè∏ÂÖßÈÉ® ModulesÔºåÁÑ°Ê≥ïÂàÜ‰∫´Ë´ãË¶ãË´íÔºåÊúâÂïèÈ°åÂèØ‰ª•Ë©¢ÂïèÂì¶\n‰∏ªË¶ÅÊñ∞Â¢û\ns3_import_bucket_name = \u0026#34;aws_s3_bucket_name\u0026#34; s3_import_ingestion_role = \u0026#34;arn:aws:iam::xxxxxxxxxxxx:role/rds-restore-from-s3-role\u0026#34; ÂÖ∂È§òÂ∞±Ë∑ü‰∏ÄËà¨‰ΩøÁî® Terraform ‰æÜÈÉ®ÁΩ≤ RDS ‰∏ÄÊ®£\ns3_import_bucket_name : Ë¶ÅÈÇÑÂéüÁöÑ s3 bucket ÂêçÁ®± s3_import_ingestion_role : ‰ΩøÁî®Âì™ÂÄã Role ‰æÜÂü∑Ë°å Configuring external source replication # AWS RDS Documentation : Configuring, starting, and stopping binary log ( binlog ) replication\n### ÈÄ£Âà∞ RDSÔºåÂü∑Ë°å‰ª•‰∏ã Stored Procedures CALL mysql.rds_set_external_master_with_auto_position ( host_name , host_port , replication_user_name , replication_user_password , ssl_encryption , delay ); ### Êú¨Ê¨°ÁØÑ‰æã‰ΩøÁî®ÁöÑÊåá‰ª§ CALL mysql.rds_set_external_master_with_auto_position ( \u0026#39;35.221.236.11\u0026#39; , 3306 , \u0026#39;aws_rds_rep\u0026#39; , \u0026#39;YangTest@123\u0026#39; , 1 , 0 ); ### ÈñãÂßãÂêåÊ≠• CALL mysql.rds_start_replication; ### ÁÑ∂ÂæåÂ∞±ÊàêÂäü‰∫Ü SHOW SLAVE STATUS \\G Slave_IO_Running: Yes Slave_SQL_Running: Yes p.s. Â¶ÇÊûú PXB ÁöÑ‰æÜÊ∫êÊòØ Replica ÁöÑË©±Ôºå\nÂèØ‰ª•‰∏çÁî®ÈáçÊñ∞Ë®≠ÂÆö rds_set_external_master_with_auto_positionÔºå\nÂõ†ÁÇ∫Áõ∏ÈóúË≥áÊñôÂ∑≤Á∂ìÂ≠òÊîæÊñº mysql.slave_master_info ‰∏≠Ôºå\nÂè™ÈúÄË¶ÅÂü∑Ë°å mysql.rds_start_replication Âç≥ÂèØ\nTroubleshooting #Q : [ÂÖßÈÉ®Ëá™Á†îÂπ≥Âè∞] ÈÅ∏‰∏çÂà∞Ëá™Âª∫ÁöÑ Subnets #A : Âõ†ÁÇ∫Ë®≠ÂÆöÊ™î‰∏≠ÊúâÂèÉÊï∏‰æÜÊ±∫ÂÆöÂπ≥Âè∞Âª∫ÁΩÆÊ©üÂô®ÊâÄÈúÄË¶Å‰ΩøÁî®Âà∞ÁöÑ Á∂≤Ë∑ØÂ∞àÊ°àÔºå\nÊúÉÈÄôÊ®£Ë®≠Ë®àÁöÑÂéüÂõ†ÊòØÂõ†ÁÇ∫ÊàëÂÄëÁ∂≤Ë∑ØÁí∞Â¢ÉÂ§ßÂ§öÊòØ‰ΩøÁî® XPN Êû∂ÊßãÔºå\nÊâÄ‰ª•ÈúÄË¶ÅÂ∞á Á∂≤Ë∑ØÂ∞àÊ°à Ë®≠ÂÆöÁÇ∫‰∏çÂêåÁöÑ Project\nQ : [ÂÖßÈÉ®Ëá™Á†îÂπ≥Âè∞] ÈÇÑÊòØÈÅ∏‰∏çÂà∞ÂëÄ #A : È°û‰ººÂïèÈ°åÔºåÂõ†ÁÇ∫Ë®≠ÂÆöÊ™î‰∏≠ÊúâË®≠ÂÆö filter ‰æÜÈÅéÊøæ SubnetsÔºå\nÂéüÂõ†ÊòØÂõ†ÁÇ∫Êó©Êúü GCP Â∞àÊ°à‰ΩøÁî®ÁöÑÁ∂≤Ë∑ØÊû∂ÊßãÊòØ VPC ‰∏çÂàÜÁí∞Â¢ÉÔºå\n‰πüÂ∞±ÊòØ prod„ÄÅstaging ‰ª•Âèä test Á≠âÁ≠âÈÉΩÂú®Âêå‰∏ÄÂÄã VPC Â∫ï‰∏ãÔºå\n‰ΩÜÂú®Ëá™Á†îÂπ≥Âè∞‰∏≠ÈúÄË¶ÅÂçÄÂàÜÁí∞Â¢ÉÔºå\nÊâÄ‰ª•ÊâçËóâÁî± filter ‰æÜÈÅéÊøæÈúÄË¶ÅÁöÑ Subnets\nQ : [IAP] failed to connect to backend #A : ÊàëÂÄëÁõÆÂâçÈÄ£Á∑öÂà∞ GCE ÈÉΩÊòØËóâÁî± IAP ‰æÜÂØ¶ÁèæÔºå\nÂèØÂèÉËÄÉ GCP IAP Doc Âª∫ÁΩÆ FW ÂæåÂ∞±ÂèØ‰ª•ÈÄ£Á∑öÂõâ!\n### Allow IAP Access ( CIDR ÊòØÂõ∫ÂÆöÁöÑ ) gcloud compute firewall-rules create allow-iap-access \\ --project=${PROJECT_ID} \\ --direction=INGRESS \\ --priority=1000 \\ --network=${VPC_NAME} \\ --action=ALLOW \\ --rules=tcp:22 \\ --source-ranges=35.235.240.0/20 Q : [startup-script] Ê≤íÊúâÂü∑Ë°å #A : Âõ†ÁÇ∫Ê©üÂô®ÁÑ°Ê≥ïÂ∞çÂ§ñÔºåÈúÄË¶ÅË®≠ÂÆö Cloud NAT\n### Create Cloud Router ( aws-test-router ) gcloud compute routers create aws-test-router \\ --project=${PROJECT_ID} \\ --region=asia-east1 \\ --network=${VPC_NAME} ### Create Cloud NAT gateway ( aws-test-nat ) gcloud compute routers nats create aws-test-nat \\ --project=${PROJECT_ID} \\ --router=aws-test-router \\ --region=asia-east1 \\ --nat-all-subnet-ip-ranges \\ --auto-allocate-nat-external-ips Q : [startup-script] Áõ£ÊéßÂÆâË£ùÂ§±Êïó #A : ÈÄôÊòØ‰∏ÄÈÄ£‰∏≤ÁöÑÈåØË™§ÈÄ†ÊàêÁöÑÁµêÊûúÔºå\nRoot Cause ÊòØÂõ†ÁÇ∫ÂëºÂè´‰∏çÂà∞ÂÖßÈÉ®ÁöÑ APIÔºå\nÊâÄ‰ª•Ê≤íËæ¶Ê≥ïÂèñÂæó my.cnf ÁöÑË®≠ÂÆöÔºå\nÈÄ†Êàê my.cnf ‰ΩøÁî® MySQL È†êË®≠ÁöÑË®≠ÂÆöÔºå\nÂ∞éËá¥ startup-script Âü∑Ë°å‰øÆÊîπÂ∏≥ÂØÜÊôÇÊ≤íËæ¶Ê≥ïÂèñÂæóÂØÜÁ¢ºËÄå‰øÆÊîπÂ§±ÊïóÔºå\nÊúÄÁµÇÈÄ†ÊàêÁöÑÁµêÊûúÂ∞±ÊòØÁõ£ÊéßÊ≤íËæ¶Ê≥ïÁôªÂÖ•ÔºåÂá∫ÁèæÂÆâË£ùÂ§±Êïó\nËß£Ê±∫Ëæ¶Ê≥ïÔºåÊö´ÊôÇÂ∞á ‰∏äËø∞ Cloud NAT Áî¢ÁîüÁöÑ IP Êñ∞Â¢ûËá≥ API ÁöÑ allow_list\nÊàêÂäüÂæåË®òÂæóÂà™Èô§ allow_list Q : [SSO] oauth callback error 127.0.0.1 # A : ‰ΩøÁî® aws configure sso ÊôÇÊúÉË∑≥ OAuth callback Â§±ÊïóÔºå\nË´ãÂèÉËÄÉ New SSO Implementation Broken When Used Across Multiple Machines ¬∑ Issue #9228 ¬∑ aws/aws-cliÔºå\nÂä†‰∏ä --use-device-code Âç≥ÂèØ\nQ : [AWS IAM] ÂêÑÁ®ÆÊ¨äÈôêÈåØË™§ #A : Ê∫êËá™ÊñºÂ∞ç AWS IAM ‰∏çÁÜüÊÇâÂ∞éËá¥Ôºå\nÂü∫Êú¨‰∏äÈÄôÂú® AWS Doc ‰∏≠ÈÉΩÊúâÊèêÂà∞ Creating an IAM role manually\nTrust Policy # ÂèØËÉΩÊàëÊ≤íÊÖßÊ†πÔºåÂÆòÊñπÊèê‰æõÁöÑÁØÑ‰æãÁúüÁöÑÂæàÁØÑ‰æãÔºå\nÈÄôÈÇäÁöÑ Service Ë¶ÅÂ°´ÂÖ• rds.amazonaws.com\n{\u0026quot;Service\u0026quot;: \u0026quot;rds.amazonaws.com\u0026quot;}\n‰ª£Ë°®ÈÄôÂÄã Role ÂèØ‰ª•ËÆì RDS Assume\nRole Permissions # Âõ†ÁÇ∫ÈÄôÈÇäÊàëÊ≤íÊúâ Create inline policy ÁöÑÊ¨äÈôêÔºå\nÊâÄ‰ª•ÊàëÂè™ËÉΩÂÖàÁµ¶ AWS managed ÁöÑ PolicyÔºå\nÁÇ∫‰∫ÜÁ¨¶ÂêàÈúÄÊ±ÇÔºåÊàëÈÄôÈÇäÊòØË≥¶‰∫à‰∫Ü AmazonS3ReadOnlyAccess Ê¨äÈôê\n‰ª£Ë°®ÈÄôÂÄã Role ÊìÅÊúâ S3 ReadOnly ÁöÑÊ¨äÈôê\niam:PassRole # ÂèàÊòØ‰∏ÄÂÄãÊàëÊ≤íÊÖßÊ†πÁöÑÁØÑ‰æãÔºå\nÈÄôÊòØË¶ÅÂä†Âú® ‰ΩøÁî®ËÄÖ ÁöÑÊ¨äÈôêÔºå\n‰ª•ÊàëÂÄëÁõÆÂâç AWS Account ÁöÑË¶èÂäÉ‰æÜË™™Ôºå\nÂ≠òÂú®‰∏ÄÂÄã RolesÔºåÂêçÁ®±ÁÇ∫ AWSReservedSSO_DatabaseAdministrator_xxxxxxÔºå\nË¶ÅÂ∞áÊ¨äÈôêÂä†Âà∞Ë©≤ Roles ‰∏äÔºå\n‰ª£Ë°® ÊìÅÊúâ PassRole S3Access ÈÄôÂÄã Role Áµ¶ Service ÁöÑÊ¨äÈôê\nÈ°çÂ§ñË™™Êòé‰∏Ä‰∏ãÁÇ∫‰ªÄÈ∫º AWS ÊúÉË®≠Ë®à iam:PassRole ÁöÑÂéüÂõ†Ôºå\n‰∏ªË¶ÅÊòØÂÆâÂÖ®‰∏äÁöÑËÄÉÈáè\n‰ªäÂ§©Êúâ‰∏Ä‰Ωç User Âª∫‰∫Ü‰∏ÄÂè∞ EC2Ôºå‰∏¶Ë≥¶‰∫à EC2 Instance Role ÁöÑÊ¨äÈôêÔºå\n‰∏ÄÂàáÈÉΩÂæàÊ≠£Â∏∏„ÄÅÂæàÁæéÂ•Ω ü§óü§óü§ó\nÊúâÂÄã Bad User Âá∫Áèæ‰∫ÜÔºå\n‰ªñÊòéÊòéÂè™Êúâ LimitedAccessPolicy ÁöÑÊ¨äÈôêÔºåÁêÜË´ñ‰∏äÊ¨äÈôêËºÉ‰ΩéÔºå\n‰ΩÜÂõ†ÁÇ∫Âª∫‰∫Ü‰∏ÄÂè∞ EC2Ôºå‰∏¶Ë≥¶‰∫à EC2 ÊúâËºÉÈ´òÊ¨äÈôêÁöÑ AdministratorAccess RoleÔºå\nÈÄôÊôÇ Bad User Â∞±ÂèØ‰ª•ËóâÁî± SSH Âà∞Ë©≤Âè∞ EC2 InstanceÔºå\n‰ΩøÁî®ËºÉÈ´òÊ¨äÈôêÁöÑ Role ÂéªÂëºÂè´ AWS ÁöÑ APIsÔºå\nÊ¨äÈôêÂ∞±Ë¢´ÁπûÈÅéÂéª‰∫Ü\nËß£Ê±∫ÊñπÊ°à iam:PassRole Âá∫Áèæ‰∫Ü!\n‰∏ªË¶ÅÊòØÁî®‰æÜ ÈôêÂà∂ User ÂèØ‰ª•ÊääÂì™‰∫õ Role Ë≥¶‰∫à Service ‰ΩøÁî®ÁöÑÊ¨äÈôê\n‰ª•‰∏ä‰æãÂ≠ê‰æÜË™™ÔºåÊàëÂÄëÂèØ‰ª•Êñ∞Â¢û Allow iam:PassRole LimitedAccess\n{ \u0026#34;Effect\u0026#34;: \u0026#34;Allow\u0026#34;, \u0026#34;Action\u0026#34;: \u0026#34;iam:PassRole\u0026#34;, \u0026#34;Resource\u0026#34;: \u0026#34;arn:aws:::123456789012:role/LimitedAccess\u0026#34; } Bad User ‰æø‰∏çËÉΩË≥¶‰∫à AdministratorAccess Role ÁöÑÊ¨äÈôêÁµ¶ EC2 ServiceÔºå\nÂè™ËÉΩË≥¶‰∫à LimitedAccess RoleÔºå‰∏ÄÂ§©ÂèàÂπ≥ÂÆâÁöÑÈÅéÂéª‰∫ÜÔºåÂèØÂñúÂèØË≥Ä ü§óü§óü§ó\nSummary #Âü∫Êú¨‰∏äÈÄôÂÄã‰ªªÂãôÊÉ≥ÂÉèËµ∑‰æÜÊ≤íÊúâ‰ªÄÈ∫ºÂ§™Â§ßÁöÑÂõ∞Èõ£Ôºå\nÂØ¶ÈöõÊåâÁÖßÂÆòÊñπ Documentation Êìç‰Ωú‰πüÂè™ÊúâÂ∞ëÂ∞ëÁöÑ 1-2 È†ÅÔºå\n‰ΩÜÂ∞±Â¶ÇÂêåÊú¨ÁØáÊñáÁ´†ÁöÑÁèæÂØ¶Ë°ùÊìäÔºå\nTroubleshooting ÁöÑÁØáÂπÖÂ§ßÊ¶ÇÊØîÂØ¶ÈöõÊìç‰ΩúÂ§ö‰∫Ü‰∏ÄÂÄç‰ª•‰∏äÔºå\nÈóúÈóúÈõ£ÈÅéÔºå‰ΩÜÂ∞±ÈóúÈóúÈÅéÂêß\nÊÅêÊáº‰æÜËá™ÁÇ∫Êú™Áü•\nÈÅáÂà∞‰∫ÜÔºåÂ∞±‰∫ÜËß£ÂÆÉ\n‰∫ÜËß£‰∫ÜÔºåÂ∞±‰∏çÂÜçÂÆ≥ÊÄï Reference # AWS RDS Documentation : Restoring a backup into an Amazon RDS for MySQL DB instance AWS RDS Documentation : Configuring binary log file position replication with an eternal source instance Rowan Udell : AWS IAM:PassRole explained ","date":"16 September 2025","permalink":"https://yangnianli.github.io/blog/restoring-a-backup-into-an-amazon-rds-for-mysql-db-instance-and-configuring-external-source-replication/","section":"Blog","summary":"","title":"[AWS] Restoring a backup into an Amazon RDS for MySQL DB instance and Configuring external source replication"},{"content":" Insanity is doing the same thing over and over and expecting a different result. ","date":null,"permalink":"https://yangnianli.github.io/blog/","section":"Blog","summary":"","title":"Blog"},{"content":"","date":null,"permalink":"https://yangnianli.github.io/tags/rds/","section":"Tags","summary":"","title":"Rds"},{"content":"","date":null,"permalink":"https://yangnianli.github.io/tags/sre/","section":"Tags","summary":"","title":"Sre"},{"content":"About Me # Yang He lives in Taichung City with his SPOF (wife) and two replicas\n- v1.0 (boy) and v2.0 (girl), both in primary school. mysql\u0026gt; SELECT -\u0026gt; `Name` AS Name , -\u0026gt; `JobTitle` AS JobTitle , -\u0026gt; `Description` AS Description -\u0026gt; FROM whoami \\G *************************** 1. row *************************** Name: Yang JobTitle: Database Administrator (DBA) / Database Reliability Engineer (DBRE) Description: ÊìÅÊúâ 10+ Âπ¥ DBA Á∂ìÈ©óÔºå Â∞àÁ≤æ MySQLÔºåÁÆ°ÁêÜ TB Á¥öË≥áÊñôÂ∫´„ÄÅË∂ÖÈÅé 600 Âè∞„ÄÅÁ¥Ñ 100 Â∫ß Cluster Á∂ìÈ©ó„ÄÇ ÂÖ∑ÂÇôËªüÈ´îÈñãÁôºËÉΩÂäõÔºåÁÜüÊÇâ On-Premises ‰ª•Âèä Cloud ( GCP„ÄÅAWS ) ÁÆ°ÁêÜËàáÁ∂≠ÈÅãÁ∂ìÈ©óÔºå ‰∏¶ÊìÖÈï∑‰ΩøÁî® Terraform ( OpenTofu )„ÄÅTerragrunt Á≠â IaC Â∑•ÂÖ∑‰æÜÁ∞°ÂåñËàáÁµ±‰∏ÄÂª∫ÁΩÆÊµÅÁ®ã„ÄÇ ÁÜ±ÊÑõÂ≠∏ÁøíÊñ∞Áü•Ë≠ò‰æÜËß£Ê±∫Êó•Â∏∏Á∂≠ÈÅãÂïèÈ°åÔºåÁøíÊÖ£‰∏ÄÁõ¥ËøΩÂïèËá™Â∑±ÂïèÈ°åÁõ¥Âà∞Ê≤íÊúâÁñëÂïèÁÇ∫Ê≠¢Ôºõ ‰πüÊ®ÇÊñºÂàÜ‰∫´ÔºåÂÖßÂøÉ‰∏ÄÁõ¥Áõ∏‰ø°Ëëó„ÄåÁï∂ÊàëËÉΩÂ§†ÊïôÂ≠∏‰ªñ‰∫∫ÊôÇÔºåÊâçÁÆóÊòØÁúüÊ≠£Â≠∏ÊúÉ„ÄÇ„Äç Â¶ÇÊûúÊÇ®‰πüË™çÂêåÔºåÊàëÊÉ≥ÊàëÂÄëÂèØ‰ª•Â§öËÅäËÅä üòá 1 row in set (0.0007 sec) Work Experience #","date":null,"permalink":"https://yangnianli.github.io/about/","section":"Yang's Blog","summary":"","title":""}]